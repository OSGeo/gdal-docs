

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PostgreSQL / PostGIS - Advanced Driver Information &mdash; GDAL  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/gdal.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  
    <link rel="canonical" href="https://gdal.orgdrivers/vector/pg_advanced.html"/>
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PLScenes (Planet Labs Scenes/Catalog API)" href="plscenes.html" />
    <link rel="prev" title="PostgreSQL / PostGIS" href="pg.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/gdalicon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../raster/index.html">Raster drivers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Vector drivers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aeronavfaa.html">Aeronav FAA</a></li>
<li class="toctree-l2"><a class="reference internal" href="amigocloud.html">AmigoCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="ao.html">ESRI ArcObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcgen.html">ARCGEN - Arc/Info Generate</a></li>
<li class="toctree-l2"><a class="reference internal" href="avcbin.html">Arc/Info Binary Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="avce00.html">Arc/Info E00 (ASCII) Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bna.html">BNA - Atlas BNA</a></li>
<li class="toctree-l2"><a class="reference internal" href="cad.html">CAD – AutoCAD DWG</a></li>
<li class="toctree-l2"><a class="reference internal" href="carto.html">Carto</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudant.html">Cloudant – Cloudant</a></li>
<li class="toctree-l2"><a class="reference internal" href="couchdb.html">CouchDB - CouchDB/GeoCouch</a></li>
<li class="toctree-l2"><a class="reference internal" href="csv.html">Comma Separated Value (.csv)</a></li>
<li class="toctree-l2"><a class="reference internal" href="csw.html">CSW - OGC CSW (Catalog Service for the Web)</a></li>
<li class="toctree-l2"><a class="reference internal" href="db2.html">DB2 Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="dgn.html">Microstation DGN</a></li>
<li class="toctree-l2"><a class="reference internal" href="dgnv8.html">Microstation DGN v8</a></li>
<li class="toctree-l2"><a class="reference internal" href="dods.html">DODS/OPeNDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="dwg.html">AutoCAD DWG</a></li>
<li class="toctree-l2"><a class="reference internal" href="dxf.html">AutoCAD DXF</a></li>
<li class="toctree-l2"><a class="reference internal" href="eeda.html">Google Earth Engine Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="edigeo.html">EDIGEO</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticsearch.html">Elasticsearch: Geographically Encoded Objects for Elasticsearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="esrijson.html">ESRIJSON / FeatureService driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="filegdb.html">ESRI File Geodatabase (FileGDB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flatgeobuf.html">FlatGeobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="fme.html">FMEObjects Gateway</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoconcept.html">GeoConcept text export</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojson.html">GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojsonseq.html">GeoJSONSeq: sequence of GeoJSON features</a></li>
<li class="toctree-l2"><a class="reference internal" href="geomedia.html">Geomedia MDB database</a></li>
<li class="toctree-l2"><a class="reference internal" href="georss.html">GeoRSS : Geographically Encoded Objects for RSS feeds</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmlas.html">GMLAS - Geography Markup Language (GML) driven by application schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="gml.html">GML - Geography Markup Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmt.html">GMT ASCII Vectors (.gmt)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpkg.html">GPKG – GeoPackage vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsbabel.html">GPSBabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpx.html">GPX - GPS Exchange Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="grass.html">GRASS Vector Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtm.html">GTM - GPS TrackMaker</a></li>
<li class="toctree-l2"><a class="reference internal" href="htf.html">HTF - Hydrographic Transfer Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="idb.html">IDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="idrisi.html">Idrisi Vector (.VCT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ili.html">“INTERLIS 1” and “INTERLIS 2” drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingres.html">INGRES</a></li>
<li class="toctree-l2"><a class="reference internal" href="jml.html">JML: OpenJUMP JML format</a></li>
<li class="toctree-l2"><a class="reference internal" href="kml.html">KML - Keyhole Markup Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="libkml.html">LIBKML Driver (.kml .kmz)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lvbag.html">Dutch Kadaster LV BAG 2.0 Extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="mapml.html">MapML</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdb.html">Access MDB databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="mitab.html">MapInfo TAB and MIF/MID</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodb.html">MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodbv3.html">MongoDBv3</a></li>
<li class="toctree-l2"><a class="reference internal" href="mssqlspatial.html">MSSQLSpatial - Microsoft SQL Server Spatial Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="mvt.html">MVT: Mapbox Vector Tiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="mysql.html">MySQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="nas.html">NAS - ALKIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="netcdf.html">NetCDF: Network Common Data Form - Vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngw.html">NGW – NextGIS Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="ntf.html">UK .NTF</a></li>
<li class="toctree-l2"><a class="reference internal" href="oapif.html">OGC API - Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="oci.html">Oracle Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="odbc.html">ODBC RDBMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="ods.html">ODS - Open Document Spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="ogdi.html">OGDI Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="openair.html">OpenAir - OpenAir Special Use Airspace Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="openfilegdb.html">ESRI File Geodatabase (OpenFileGDB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="osm.html">OSM - OpenStreetMap XML and PBF</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdf.html">PDF – Geospatial PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="pds.html">PDS - Planetary Data Systems TABLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgdump.html">PostgreSQL SQL Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgeo.html">ESRI Personal GeoDatabase</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="pg.html">PostgreSQL / PostGIS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pg.html#driver-capabilities">Driver capabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="pg.html#connecting-to-a-database">Connecting to a database</a></li>
<li class="toctree-l3"><a class="reference internal" href="pg.html#geometry-columns">Geometry columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="pg.html#sql-statements">SQL statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="pg.html#creation-issues">Creation Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="pg.html#faqs">FAQs</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pg.html#see-also">See Also</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">PostgreSQL / PostGIS - Advanced Driver Information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plscenes.html">PLScenes (Planet Labs Scenes/Catalog API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="s57.html">IHO S-57 (ENC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdts.html">SDTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="segukooa.html">SEG-P1 / UKOOA P1/90</a></li>
<li class="toctree-l2"><a class="reference internal" href="segy.html">SEG-Y / SEGY</a></li>
<li class="toctree-l2"><a class="reference internal" href="selafin.html">Selafin files</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapefile.html">ESRI Shapefile / DBF</a></li>
<li class="toctree-l2"><a class="reference internal" href="sosi.html">Norwegian SOSI Standard</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqlite.html">SQLite / Spatialite RDBMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="sua.html">SUA - Tim Newport-Peace’s Special Use Airspace Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="svg.html">SVG - Scalable Vector Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="sxf.html">Storage and eXchange Format - SXF</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiger.html">U.S. Census TIGER/Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="topojson.html">TopoJSON driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdv.html">VDV - VDV-451/VDV-452/INTREST Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vfk.html">VFK - Czech Cadastral Exchange Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vrt.html">VRT – Virtual Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="walk.html">Walk - Walk Spatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="wasp.html">WAsP - WAsP .map format</a></li>
<li class="toctree-l2"><a class="reference internal" href="wfs.html">WFS - OGC WFS service</a></li>
<li class="toctree-l2"><a class="reference internal" href="xls.html">XLS - MS Excel format</a></li>
<li class="toctree-l2"><a class="reference internal" href="xlsx.html">XLSX - MS Office Open XML spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="xplane.html">X-Plane/Flightgear aeronautical data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">How to contribute?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDAL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html"> GDAL  documentation </a> &raquo;</li>
      
          <li><a href="index.html">Vector drivers</a> &raquo;</li>
      
          <li><a href="pg.html">PostgreSQL / PostGIS</a> &raquo;</li>
      
      <li>PostgreSQL / PostGIS - Advanced Driver Information</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/edit//master/gdal/doc/source/drivers/vector/pg_advanced.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="plscenes.html" class="btn btn-neutral float-right" title="PLScenes (Planet Labs Scenes/Catalog API)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pg.html" class="btn btn-neutral float-left" title="PostgreSQL / PostGIS" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="postgresql-postgis-advanced-driver-information">
<span id="vector-pg-advanced"></span><h1>PostgreSQL / PostGIS - Advanced Driver Information<a class="headerlink" href="#postgresql-postgis-advanced-driver-information" title="Permalink to this headline">¶</a></h1>
<p>The information collected in that page deal with advanced topics, not
found in the <a class="reference internal" href="pg.html#vector-pg"><span class="std std-ref">OGR PostgreSQL driver Information</span></a> page.</p>
<div class="section" id="connection-options-related-to-schemas-and-tables">
<h2>Connection options related to schemas and tables<a class="headerlink" href="#connection-options-related-to-schemas-and-tables" title="Permalink to this headline">¶</a></h2>
<p>The database opening should be significantly
faster than in previous versions, so using tables= or schemas= options
will not bring further noticeable speed-ups.</p>
<p>The set of tables to be scanned can be
overridden by specifying
<em>tables=[schema.]table[(geom_column_name)][,[schema2.]table2[(geom_column_name2)],…]</em>
within the connection string. If the parameter is found, the driver
skips enumeration of the tables as described in the next paragraph.</p>
<p>It is possible to restrict the schemas that
will be scanned while establishing the list of tables. This can be done
by specifying <em>schemas=schema_name[,schema_name2]</em> within the connection
string. This can also be a way of speeding up the connection to a
PostgreSQL database if there are a lot of schemas. Note that if only one
schema is listed, it will also be made automatically the active schema
(and the schema name will not prefix the layer name). Otherwise, the
active schema is still ‘public’, unless otherwise specified by the
<em>active_schema=</em> option.</p>
<p>The active schema (‘public’ being the default)
can be overridden by specifying <em>active_schema=schema_name</em> within the
connection string. The active schema is the schema where tables are
created or looked for when their name is not explicitly prefixed by a
schema name. Note that this does not restrict the tables that will be
listed (see <em>schemas=</em> option above). When getting the list of tables,
the name of the tables within that active schema will not be prefixed by
the schema name. For example, if you have a table ‘foo’ within the
public schema, and a table ‘foo’ within the ‘bar_schema’ schema, and
that you specify active_schema=bar_schema, 2 layers will be listed :
‘foo’ (implicitly within ‘bar_schema’) and ‘public.foo’.</p>
</div>
<div class="section" id="multiple-geometry-columns">
<h2>Multiple geometry columns<a class="headerlink" href="#multiple-geometry-columns" title="Permalink to this headline">¶</a></h2>
<p>The PostgreSQL driver supports accessing
tables with multiple PostGIS geometry columns.</p>
<p>OGR supports reading, updating, creating tables with multiple
PostGIS geometry columns (following <a class="reference internal" href="../../development/rfc/rfc41_multiple_geometry_fields.html#rfc-41"><span class="std std-ref">RFC 41 : Support for multiple geometry fields in OGR</span></a>)
For such a table, a single OGR layer will be reported with as many
geometry fields as there are geometry columns in the table.</p>
<p>For backward compatibility, it is also possible to query a layer with
GetLayerByName() with a name formatted like ‘foo(bar)’ where ‘foo’ is a
table and ‘bar’ a geometry column.</p>
</div>
<div class="section" id="layers">
<h2>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h2>
<p>Even when PostGIS is enabled, if the user
defines the environment variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PG_LIST_ALL_TABLES</span><span class="o">=</span><span class="n">YES</span>
</pre></div>
</div>
<p>(and does not specify tables=), all regular user tables and named views
will be treated as layers. However, tables with multiple geometry column
will only be reported once in that mode. So this variable is mainly
useful when PostGIS is enabled to find out tables with no spatial data,
or views without an entry in <em>geometry_columns</em> table.</p>
<p>In any case, all user tables can be queried explicitly with
GetLayerByName()</p>
<p>Regular (non-spatial) tables can be accessed, and will return features
with attributes, but not geometry. If the table has a “wkb_geometry”
field, it will be treated as a spatial table. The type of the field is
inspected to determine how to read it. It can be a PostGIS <strong>geometry</strong>
field, which is assumed to come back in OGC WKT, or type BYTEA or OID in
which case it is used as a source of OGC WKB geometry.</p>
<p>Tables inherited from spatial tables are
supported.</p>
<p>If there is an “ogc_fid” field, it will be used to set the feature id of
the features, and not treated as a regular field.</p>
<p>The layer name may be of the form “schema.table”. The schema must exist,
and the user needs to have write permissions for the target and the
public schema.</p>
<p>If the user defines the environment variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PG_SKIP_VIEWS</span><span class="o">=</span><span class="n">YES</span>
</pre></div>
</div>
<p>(and does not specify tables=), only the regular user tables will be
treated as layers. The default action is to include the views. This
variable is particularly useful when you want to copy the data into
another format while avoiding the redundant data from the views.</p>
</div>
<div class="section" id="named-views">
<h2>Named views<a class="headerlink" href="#named-views" title="Permalink to this headline">¶</a></h2>
<p>When PostGIS is enabled for the accessed database, named views are
supported, provided that there is an entry in the <em>geometry_columns</em>
tables. But, note that the AddGeometryColumn() SQL function doesn’t
accept adding an entry for a view (only for regular tables). So, that
must usually be done by hand with a SQL statement like :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;INSERT INTO geometry_columns VALUES ( &#39;&#39;, &#39;public&#39;, &#39;name_of_my_view&#39;, &#39;name_of_geometry_column&#39;, 2, 4326, &#39;POINT&#39;);&quot;</span>
</pre></div>
</div>
<p>It is also possible to use named views without
inserting a row in the geometry_columns table. For that, you need to
explicitly specify the name of the view in the “tables=” option of the
connection string. See above. The drawback is that OGR will not be able
to report a valid SRS and figure out the right geometry type.</p>
</div>
<div class="section" id="retrieving-fid-of-newly-inserted-feature">
<h2>Retrieving FID of newly inserted feature<a class="headerlink" href="#retrieving-fid-of-newly-inserted-feature" title="Permalink to this headline">¶</a></h2>
<p>The FID of
a feature (i.e. usually the value of the OGC_FID column for the feature)
inserted into a table with CreateFeature(), in non-copy mode, will be
retrieved from the database and can be obtained with GetFID(). One
side-effect of this new behavior is that you must be careful if you
re-use the same feature object in a loop that makes insertions. After
the first iteration, the FID will be set to a non-null value, so at the
second iteration, CreateFeature() will try to insert the new feature
with the FID of the previous feature, which will fail as you cannot
insert 2 features with same FID. So in that case you must explicitly
reset the FID before calling CreateFeature(), or use a fresh feature
object.</p>
<p>Snippet example in Python :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feat</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">lyr</span><span class="o">.</span><span class="n">GetLayerDefn</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">feat</span><span class="o">.</span><span class="n">SetFID</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Reset FID to null value</span>
    <span class="n">lyr</span><span class="o">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The feature has been assigned FID </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetFID</span><span class="p">())</span>
</pre></div>
</div>
<p>or :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">feat</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">lyr</span><span class="o">.</span><span class="n">GetLayerDefn</span><span class="p">())</span>
    <span class="n">lyr</span><span class="o">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The feature has been assigned FID </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetFID</span><span class="p">())</span>
</pre></div>
</div>
<p>Old GDAL behavior can be obtained by setting the configuration
option <code class="decl_configoption docutils literal notranslate"><span class="pre">OGR_PG_RETRIEVE_FID</span></code> to FALSE.</p>
</div>
<div class="section" id="issues-with-transactions">
<h2>Issues with transactions<a class="headerlink" href="#issues-with-transactions" title="Permalink to this headline">¶</a></h2>
<p>Efficient sequential reading in PostgreSQL requires to be done within a
transaction (technically this is a CURSOR WITHOUT HOLD). So the PG
driver will implicitly open such a transaction if none is currently
opened as soon as a feature is retrieved. This transaction will be
released if ResetReading() is called (provided that no other layer is
still being read).</p>
<p>If within such an implicit transaction, an explicit dataset level
StartTransaction() is issued, the PG driver will use a SAVEPOINT to
emulate properly the transaction behavior while making the active
cursor on the read layer still opened.</p>
<p>If an explicit transaction is opened with dataset level
StartTransaction() before reading a layer, this transaction will be used
for the cursor that iterates over the layer. When explicitly committing
or rolling back the transaction, the cursor will become invalid, and
ResetReading() should be issued again to restart reading from the
beginning.</p>
<p>As calling SetAttributeFilter() or SetSpatialFilter() implies an
implicit ResetReading(), they have the same effect as ResetReading().
That is to say, while an implicit transaction is in progress, the
transaction will be committed (if no other layer is being read), and a
new one will be started again at the next GetNextFeature() call. On the
contrary, if they are called within an explicit transaction, the
transaction is maintained.</p>
<p>With the above rules, the below examples show the SQL instructions that
are run when using the OGR API in different scenarios.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">BEGIN</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>
                                   <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span> <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">SetAttributeFilter</span><span class="p">(</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
     <span class="o">--&gt;</span> <span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>      <span class="n">CLOSE</span> <span class="n">cur1</span>
                                   <span class="n">COMMIT</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">BEGIN</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>
                                   <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span>  <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span> <span class="n">WHERE</span> <span class="n">xxx</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr2</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">DECLARE</span> <span class="n">cur2</span> <span class="n">CURSOR</span>  <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr2</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur2</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr2</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur2</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>             <span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">cur1</span> <span class="o">...</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">SetAttributeFilter</span><span class="p">(</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
     <span class="o">--&gt;</span> <span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>      <span class="n">CLOSE</span> <span class="n">cur1</span>
                                   <span class="n">COMMIT</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span>  <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span> <span class="n">WHERE</span> <span class="n">xxx</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>               <span class="n">CLOSE</span> <span class="n">cur1</span>

<span class="n">lyr2</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>               <span class="n">CLOSE</span> <span class="n">cur2</span>
                                   <span class="n">COMMIT</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>

<span class="o">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

<span class="n">ds</span><span class="o">-&gt;</span><span class="n">StartTransaction</span><span class="p">()</span>             <span class="n">BEGIN</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span> <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr2</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">DECLARE</span> <span class="n">cur2</span> <span class="n">CURSOR</span> <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr2</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur2</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>             <span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">cur1</span> <span class="o">...</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">SetAttributeFilter</span><span class="p">(</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
     <span class="o">--&gt;</span> <span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>      <span class="n">CLOSE</span> <span class="n">cur1</span>
                                   <span class="n">COMMIT</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span>  <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span> <span class="n">WHERE</span> <span class="n">xxx</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>               <span class="n">CLOSE</span> <span class="n">cur1</span>

<span class="n">lyr2</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>               <span class="n">CLOSE</span> <span class="n">cur2</span>

<span class="n">ds</span><span class="o">-&gt;</span><span class="n">CommitTransaction</span><span class="p">()</span>            <span class="n">COMMIT</span>

<span class="o">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

<span class="n">ds</span><span class="o">-&gt;</span><span class="n">StartTransaction</span><span class="p">()</span>             <span class="n">BEGIN</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span> <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>             <span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">cur1</span> <span class="o">...</span>

<span class="n">ds</span><span class="o">-&gt;</span><span class="n">CommitTransaction</span><span class="p">()</span>            <span class="n">CLOSE</span> <span class="n">cur1</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>
                                   <span class="n">COMMIT</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>      <span class="o">==&gt;</span> <span class="n">Error</span> <span class="n">since</span> <span class="n">the</span> <span class="n">cursor</span> <span class="n">was</span> <span class="n">closed</span> <span class="k">with</span> <span class="n">the</span> <span class="n">commit</span><span class="o">.</span> <span class="n">Explicit</span> <span class="n">ResetReading</span><span class="p">()</span> <span class="n">required</span> <span class="n">before</span>

<span class="o">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">()</span>             <span class="n">BEGIN</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>
                                   <span class="n">DECLARE</span> <span class="n">cur1</span> <span class="n">CURSOR</span> <span class="n">FOR</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">lyr1</span>
                                   <span class="n">FETCH</span> <span class="mi">1</span> <span class="n">IN</span> <span class="n">cur1</span>

<span class="n">ds</span><span class="o">-&gt;</span><span class="n">StartTransaction</span><span class="p">()</span>             <span class="n">SAVEPOINT</span> <span class="n">savepoint</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>             <span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">cur1</span> <span class="o">...</span>

<span class="n">ds</span><span class="o">-&gt;</span><span class="n">CommitTransaction</span><span class="p">()</span>            <span class="n">RELEASE</span> <span class="n">SAVEPOINT</span> <span class="n">savepoint</span>

<span class="n">lyr1</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">()</span>               <span class="n">CLOSE</span> <span class="n">cur1</span>
                                   <span class="n">COMMIT</span> <span class="p">(</span><span class="n">implicit</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: in reality, the PG drivers fetches 500 features at once. The FETCH
1 is for clarity of the explanation.</p>
</div>
<div class="section" id="advanced-examples">
<h2>Advanced Examples<a class="headerlink" href="#advanced-examples" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>This example shows using ogrinfo to list only the layers specified by
the <em>tables=</em> options.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="o">-</span><span class="n">ro</span> <span class="n">PG</span><span class="p">:</span><span class="s1">&#39;dbname=warmerda tables=table1,table2&#39;</span>
</pre></div>
</div>
</li>
<li><p>This example shows using ogrinfo to query a table ‘foo’ with multiple
geometry columns (‘geom1’ and ‘geom2’).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="o">-</span><span class="n">ro</span> <span class="o">-</span><span class="n">al</span> <span class="n">PG</span><span class="p">:</span><span class="n">dbname</span><span class="o">=</span><span class="n">warmerda</span> <span class="s1">&#39;foo(geom2)&#39;</span>
</pre></div>
</div>
</li>
<li><p>This example show how to list only the layers inside the schema
apt200810 and apt200812. The layer names will be prefixed by the name
of the schema they belong to.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="o">-</span><span class="n">ro</span> <span class="n">PG</span><span class="p">:</span><span class="s1">&#39;dbname=warmerda schemas=apt200810,apt200812&#39;</span>
</pre></div>
</div>
</li>
<li><p>This example shows using ogrinfo to list only the layers inside the
schema named apt200810. Note that the layer names will not be
prefixed by apt200810 as only one schema is listed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="o">-</span><span class="n">ro</span> <span class="n">PG</span><span class="p">:</span><span class="s1">&#39;dbname=warmerda schemas=apt200810&#39;</span>
</pre></div>
</div>
</li>
<li><p>This example shows how to convert a set of shapefiles inside the
apt200810 directory into an existing Postgres schema apt200810. In
that example, we could have use the schemas= option instead.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">PostgreSQL</span> <span class="s2">&quot;PG:dbname=warmerda active_schema=apt200810&quot;</span> <span class="n">apt200810</span>
</pre></div>
</div>
</li>
<li><p>This example shows how to convert all the tables inside the schema
apt200810 as a set of shapefiles inside the apt200810 directory. Note
that the layer names will not be prefixed by apt200810 as only one
schema is listed</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="n">apt200810</span> <span class="n">PG</span><span class="p">:</span><span class="s1">&#39;dbname=warmerda schemas=apt200810&#39;</span>
</pre></div>
</div>
</li>
<li><p>This example shows how to overwrite an existing table in an existing
schema. Note the use of -nln to specify the qualified layer name.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">overwrite</span> <span class="o">-</span><span class="n">f</span> <span class="n">PostgreSQL</span> <span class="s2">&quot;PG:dbname=warmerda&quot;</span> <span class="n">mytable</span><span class="o">.</span><span class="n">shp</span> <span class="n">mytable</span> <span class="o">-</span><span class="n">nln</span> <span class="n">myschema</span><span class="o">.</span><span class="n">mytable</span>
</pre></div>
</div>
<p>Note that using -lco SCHEMA=mytable instead of -nln would not have
worked in that case (see
<a class="reference external" href="http://trac.osgeo.org/gdal/ticket/2821">#2821</a> for more details).</p>
<p>If you need to overwrite many tables located in a schema at once, the
-nln option is not the more appropriate, so it might be more
convenient to use the active_schema connection string.
The following example will overwrite, if necessary, all
the PostgreSQL tables corresponding to a set of shapefiles inside the
apt200810 directory :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">overwrite</span> <span class="o">-</span><span class="n">f</span> <span class="n">PostgreSQL</span> <span class="s2">&quot;PG:dbname=warmerda active_schema=apt200810&quot;</span> <span class="n">apt200810</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="pg.html#vector-pg"><span class="std std-ref">OGR PostgreSQL driver Information</span></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plscenes.html" class="btn btn-neutral float-right" title="PLScenes (Planet Labs Scenes/Catalog API)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pg.html" class="btn btn-neutral float-left" title="PostgreSQL / PostGIS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2021 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>