

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Selafin files &mdash; GDAL  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://gdal.orgdrivers/vector/selafin.html"/>
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/gdal.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ESRI Shapefile / DBF" href="shapefile.html" />
    <link rel="prev" title="SEG-Y / SEGY" href="segy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/gdalicon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../raster/index.html">Raster drivers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Vector drivers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aeronavfaa.html">Aeronav FAA</a></li>
<li class="toctree-l2"><a class="reference internal" href="amigocloud.html">AmigoCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="ao.html">ESRI ArcObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcgen.html">ARCGEN - Arc/Info Generate</a></li>
<li class="toctree-l2"><a class="reference internal" href="avcbin.html">Arc/Info Binary Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="avce00.html">Arc/Info E00 (ASCII) Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bna.html">BNA - Atlas BNA</a></li>
<li class="toctree-l2"><a class="reference internal" href="cad.html">CAD – AutoCAD DWG</a></li>
<li class="toctree-l2"><a class="reference internal" href="carto.html">Carto</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudant.html">Cloudant – Cloudant</a></li>
<li class="toctree-l2"><a class="reference internal" href="couchdb.html">CouchDB - CouchDB/GeoCouch</a></li>
<li class="toctree-l2"><a class="reference internal" href="csv.html">Comma Separated Value (.csv)</a></li>
<li class="toctree-l2"><a class="reference internal" href="csw.html">CSW - OGC CSW (Catalog Service for the Web)</a></li>
<li class="toctree-l2"><a class="reference internal" href="db2.html">DB2 Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="dgn.html">Microstation DGN</a></li>
<li class="toctree-l2"><a class="reference internal" href="dgnv8.html">Microstation DGN v8</a></li>
<li class="toctree-l2"><a class="reference internal" href="dods.html">DODS/OPeNDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="dwg.html">AutoCAD DWG</a></li>
<li class="toctree-l2"><a class="reference internal" href="dxf.html">AutoCAD DXF</a></li>
<li class="toctree-l2"><a class="reference internal" href="eeda.html">Google Earth Engine Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="edigeo.html">EDIGEO</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticsearch.html">Elasticsearch: Geographically Encoded Objects for Elasticsearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="esrijson.html">ESRIJSON / FeatureService driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="filegdb.html">ESRI File Geodatabase (FileGDB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flatgeobuf.html">FlatGeobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="fme.html">FMEObjects Gateway</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoconcept.html">GeoConcept text export</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojson.html">GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojsonseq.html">GeoJSONSeq: sequence of GeoJSON features</a></li>
<li class="toctree-l2"><a class="reference internal" href="geomedia.html">Geomedia MDB database</a></li>
<li class="toctree-l2"><a class="reference internal" href="georss.html">GeoRSS : Geographically Encoded Objects for RSS feeds</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmlas.html">GMLAS - Geography Markup Language (GML) driven by application schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="gml.html">GML - Geography Markup Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmt.html">GMT ASCII Vectors (.gmt)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpkg.html">GPKG – GeoPackage vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsbabel.html">GPSBabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpx.html">GPX - GPS Exchange Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="grass.html">GRASS Vector Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtm.html">GTM - GPS TrackMaker</a></li>
<li class="toctree-l2"><a class="reference internal" href="htf.html">HTF - Hydrographic Transfer Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="idb.html">IDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="idrisi.html">Idrisi Vector (.VCT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ili.html">“INTERLIS 1” and “INTERLIS 2” drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingres.html">INGRES</a></li>
<li class="toctree-l2"><a class="reference internal" href="jml.html">JML: OpenJUMP JML format</a></li>
<li class="toctree-l2"><a class="reference internal" href="kml.html">KML - Keyhole Markup Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="libkml.html">LIBKML Driver (.kml .kmz)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mapml.html">MapML</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdb.html">Access MDB databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="mitab.html">MapInfo TAB and MIF/MID</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodb.html">MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodbv3.html">MongoDBv3</a></li>
<li class="toctree-l2"><a class="reference internal" href="mssqlspatial.html">MSSQLSpatial - Microsoft SQL Server Spatial Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="mvt.html">MVT: Mapbox Vector Tiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="mysql.html">MySQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="nas.html">NAS - ALKIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="netcdf.html">NetCDF: Network Common Data Form - Vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngw.html">NGW – NextGIS Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="ntf.html">UK .NTF</a></li>
<li class="toctree-l2"><a class="reference internal" href="oapif.html">OGC API - Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="oci.html">Oracle Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="odbc.html">ODBC RDBMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="ods.html">ODS - Open Document Spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="ogdi.html">OGDI Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="openair.html">OpenAir - OpenAir Special Use Airspace Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="openfilegdb.html">ESRI File Geodatabase (OpenFileGDB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="osm.html">OSM - OpenStreetMap XML and PBF</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdf.html">PDF – Geospatial PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="pds.html">PDS - Planetary Data Systems TABLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgdump.html">PostgreSQL SQL Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgeo.html">ESRI Personal GeoDatabase</a></li>
<li class="toctree-l2"><a class="reference internal" href="pg.html">PostgreSQL / PostGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="plscenes.html">PLScenes (Planet Labs Scenes/Catalog API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="s57.html">IHO S-57 (ENC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sde.html">ESRI ArcSDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdts.html">SDTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="segukooa.html">SEG-P1 / UKOOA P1/90</a></li>
<li class="toctree-l2"><a class="reference internal" href="segy.html">SEG-Y / SEGY</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Selafin files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#driver-capabilities">Driver capabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#magic-bytes">Magic bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#format">Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#elements">Elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#full-structure">Full structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mapping-between-file-and-layers">Mapping between file and layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#layers-in-a-selafin-datasource">Layers in a Selafin datasource</a></li>
<li class="toctree-l4"><a class="reference internal" href="#constraints-on-layers">Constraints on layers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#layer-filtering-specification">Layer filtering specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datasource-creation-options">Datasource creation options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layer-creation-options">Layer creation options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes-about-the-creation-and-the-update-of-a-selafin-datasource">Notes about the creation and the update of a Selafin datasource</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vsi-virtual-file-system-api-support">VSI Virtual File System API support</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-notes">Other notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="shapefile.html">ESRI Shapefile / DBF</a></li>
<li class="toctree-l2"><a class="reference internal" href="sosi.html">Norwegian SOSI Standard</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqlite.html">SQLite / Spatialite RDBMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="sua.html">SUA - Tim Newport-Peace’s Special Use Airspace Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="svg.html">SVG - Scalable Vector Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="sxf.html">Storage and eXchange Format - SXF</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiger.html">U.S. Census TIGER/Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="topojson.html">TopoJSON driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdv.html">VDV - VDV-451/VDV-452/INTREST Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vfk.html">VFK - Czech Cadastral Exchange Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vrt.html">VRT – Virtual Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="walk.html">Walk - Walk Spatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="wasp.html">WAsP - WAsP .map format</a></li>
<li class="toctree-l2"><a class="reference internal" href="wfs.html">WFS - OGC WFS service</a></li>
<li class="toctree-l2"><a class="reference internal" href="xls.html">XLS - MS Excel format</a></li>
<li class="toctree-l2"><a class="reference internal" href="xlsx.html">XLSX - MS Office Open XML spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="xplane.html">X-Plane/Flightgear aeronautical data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">How to contribute?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDAL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html"> GDAL  documentation </a> &raquo;</li>
      
          <li><a href="index.html">Vector drivers</a> &raquo;</li>
      
      <li>Selafin files</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/edit//master/gdal/doc/source/drivers/vector/selafin.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="shapefile.html" class="btn btn-neutral float-right" title="ESRI Shapefile / DBF" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="segy.html" class="btn btn-neutral float-left" title="SEG-Y / SEGY" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="selafin-files">
<span id="vector-selafin"></span><h1>Selafin files<a class="headerlink" href="#selafin-files" title="Permalink to this headline">¶</a></h1>
<div class="admonition shortname" id="shortname-0">
<p class="admonition-title">Driver short name</p>
<p>Selafin</p>
</div>
<div class="admonition built_in_by_default" id="built_in_by_default-0">
<p class="admonition-title">Driver built-in by default</p>
<p>This driver is built-in by default</p>
</div>
<p>OGR supports reading from 2D Selafin/Seraphin files. Selafin/Seraphin is
the generic output and input format of geographical files in the
open-source <a class="reference external" href="http://www.opentelemac.org">Telemac hydraulic model</a>.
The file format is suited to the description of numerical attributes for
a set of point features at different time steps. Those features usually
correspond to the nodes in a finite-element model. The file also holds a
connectivity table which describes the elements formed by those nodes
and which can also be read by the driver.</p>
<p>The driver supports the use of VSI virtual files as Selafin datasources.</p>
<p>The driver offers full read-write support on Selafin files. However, due
to the particular nature of Selafin files where element (polygon)
features and node (point) features are closely related, writing on
Selafin layers can lead to counter-intuitive results. In a general way,
writing on any layer of a Selafin data-source will cause side effects on
all the other layers. Also, it is very important <strong>not to open the same
datasource more than once in update mode</strong>. Having two processes write
at the same time on a single datasource can lead to irreversible data
corruption. The driver issues a warning each time a datasource is opened
in update mode.</p>
<div class="section" id="driver-capabilities">
<h2>Driver capabilities<a class="headerlink" href="#driver-capabilities" title="Permalink to this headline">¶</a></h2>
<div class="admonition supports_create" id="supports_create-0">
<p class="admonition-title">Supports Create()</p>
<p>This driver supports the <a class="reference internal" href="../../api/gdaldriver_cpp.html#_CPPv4N10GDALDriver6CreateEPKciii12GDALDataTypePPc" title="GDALDriver::Create"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDriver::Create()</span></code></a> operation</p>
</div>
<div class="admonition supports_georeferencing" id="supports_georeferencing-0">
<p class="admonition-title">Supports Georeferencing</p>
<p>This driver supports georeferencing</p>
</div>
<div class="admonition supports_virtualio" id="supports_virtualio-0">
<p class="admonition-title">Supports VirtualIO</p>
<p>This driver supports <a class="reference internal" href="../../user/virtual_file_systems.html#virtual-file-systems"><span class="std std-ref">virtual I/O operations (/vsimem/, etc.)</span></a></p>
</div>
</div>
<div class="section" id="magic-bytes">
<h2>Magic bytes<a class="headerlink" href="#magic-bytes" title="Permalink to this headline">¶</a></h2>
<p>There is no generic extension to Selafin files. The adequate format is
tested by looking at a dozen of magic bytes at the beginning of the
file:</p>
<ul class="simple">
<li><p>The first four bytes of the file should contain the values (in
hexadecimal): 00 00 00 50. This actually indicates the start of a
string of length 80 in the file.</p></li>
<li><p>At position 84 in the file, the eight next bytes should read (in
hexadecimal): 00 00 00 50 00 00 00 04.</p></li>
</ul>
<p>Files which match those two criteria are considered to be Selafin files
and the driver will report it has opened them successfully.</p>
</div>
<div class="section" id="format">
<h2>Format<a class="headerlink" href="#format" title="Permalink to this headline">¶</a></h2>
<p>Selafin format is designed to hold data structures in a portable and
compact way, and to allow efficient random access to the data. To this
purpose, Selafin files are binary files with a generic structure.</p>
<div class="section" id="elements">
<h3>Elements<a class="headerlink" href="#elements" title="Permalink to this headline">¶</a></h3>
<p>Selafin files are made of the juxtaposition of elements. Elements have
one of the following types:</p>
<ul class="simple">
<li><p>integer,</p></li>
<li><p>string,</p></li>
<li><p>floating point values,</p></li>
<li><p>arrays of integers,</p></li>
<li><p>arrays of floating point values.</p></li>
</ul>
<table class="docutils align-center">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Element</p></th>
<th class="head"><p>Internal
representation</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Integer</p></td>
<td><p>a b c d</p></td>
<td><p>Integers are stored
on 4 bytes in
big-endian format
(most significant
byte first). The
value of the integer
is
2<sup>24</sup>.a+2:su
p:<cite>16</cite>.b+2<sup>8</sup>.
c+d.</p></td>
</tr>
<tr class="row-odd"><td><p>Floating point</p></td>
<td><p>a b c d</p></td>
<td><p>Floating point values
are stored on 4 bytes
in IEEE 754 format
and under big-endian
convention (most
significant byte
first). Endianness is
detected at run time
only once when the
first floating point
value is read.</p></td>
</tr>
<tr class="row-even"><td><p>String</p></td>
<td><p>Length 1 2 … Length</p></td>
<td><p>Strings are stored in
three parts:</p>
<ul class="simple">
<li><p>an integer holding
the length (in
characters) of the
string, over 4
bytes;</p></li>
<li><p>the sequence of
characters of the
string, each
character on one
byte;</p></li>
<li><p>the same integer
with the length of
the string
repeated</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Array of integers</p></td>
<td><p>Length 1 2 … Length</p></td>
<td><p>Arrays of integers
are stored in three
parts:</p>
<ul class="simple">
<li><p>an integer holding
the length (in
bytes, thus 4
times the number
of elements) of
the array, over 4
bytes;</p></li>
<li><p>the sequence of
integers in the
array, each
integer on 4 bytes
as described
earlier;</p></li>
<li><p>the same integer
with the length of
the array repeated</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Array of floating
point values</p></td>
<td><p>Length 1 2 … Length</p></td>
<td><p>Arrays of floating
point values are
stored in three
parts:</p>
<ul class="simple">
<li><p>an integer holding
the length (in
bytes, thus 4
times the number
of elements) of
the array, over 4
bytes;</p></li>
<li><p>the sequence of
floating point
values in the
array, each one on
4 bytes as
described earlier;</p></li>
<li><p>the same integer
with the length of
the array repeated</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="full-structure">
<h3>Full structure<a class="headerlink" href="#full-structure" title="Permalink to this headline">¶</a></h3>
<p>The header of a Selafin file holds the following elements in that exact
order:</p>
<ul class="simple">
<li><p>a <em>string</em> of 80 characters with the title of the study; the last 8
characters shall be “SERAPHIN” or “SERAFIN” or “SERAFIND”;</p></li>
<li><p>an <em>array of integers</em> of exactly 2 elements, the first one being the
number of variables (attributes) <em>nVar</em>, and the second is ignored;</p></li>
<li><p><em>nVar strings</em> with the names of the variables, each one with length
32;</p></li>
<li><p>an <em>array of integers</em> of exactly 10 elements:</p>
<ul>
<li><p>the third element is the x-coordinate of the origin of the model;</p></li>
<li><p>the fourth element is the y-coordinate of the origin of the model;</p></li>
<li><p>the tenth element <em>isDate</em> indicates if the date of the model has
to be read (see later);</p></li>
<li><p>in addition, the second element being unused by hydraulic software
at the moment, it is used by the driver to store the spatial
reference system of the datasource, in the form of a single
integer with the EPSG number of the projection;</p></li>
</ul>
</li>
<li><p>if <em>isDate</em>=1, an <em>array of integers</em> of exactly 6 elements, with
the starting date of the model (year, month, day, hour, minute,
second);</p></li>
<li><p>an <em>array of integers</em> of exactly 4 elements:</p>
<ul>
<li><p>the first element is the number of elements <em>nElements</em>,</p></li>
<li><p>the second element is the number of points <em>nPoints</em>,</p></li>
<li><p>the third element is the number of points per
element<em>nPointsPerElement</em>,</p></li>
<li><p>the fourth element must be 1;</p></li>
</ul>
</li>
<li><p>an <em>array of integers</em> of exactly <em>nElements*nPointsPerElement</em>
elements, with each successive set of <em>nPointsPerElement</em> being the
list of the number of the points (number starting with 1)
constituting an element;</p></li>
<li><p>an <em>array of integers</em> of exactly <em>nPoints</em> elements ignored by the
driver (the elements shall be 0 for inner points and another value
for the border points where a limit condition is applied);</p></li>
<li><p>an <em>array of floating point values</em> of exactly <em>nPoints</em> elements
with the x-coordinates of the points;</p></li>
<li><p>an <em>array of floating point values</em> of exactly <em>nPoints</em> elements
with the y-coordinates of the points;</p></li>
</ul>
<p>The rest of the file actually holds the data for each successive time
step. A time step contains the following elements:</p>
<ul class="simple">
<li><p>a <em>array of floating point values</em> of exactly 1 element, being the
date of the time step relative to the starting date of the simulation
(usually in seconds);</p></li>
<li><p><em>nVar array of floating point values</em>, each with exactly <em>nPoints</em>
elements, with the values of each attribute for each point at the
current time step.</p></li>
</ul>
</div>
</div>
<div class="section" id="mapping-between-file-and-layers">
<h2>Mapping between file and layers<a class="headerlink" href="#mapping-between-file-and-layers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="layers-in-a-selafin-datasource">
<h3>Layers in a Selafin datasource<a class="headerlink" href="#layers-in-a-selafin-datasource" title="Permalink to this headline">¶</a></h3>
<p>The Selafin driver accepts only Selafin files as data sources.</p>
<p>Each Selafin file can hold one or several time steps. All the time steps
are read by the driver and two layers are generated for each time step:</p>
<ul class="simple">
<li><p>one layer with the nodes (points) and their attributes: its name is
the base name of the data source, followed by “_p” (for Points);</p></li>
<li><p>one layer with the elements (polygons) and their attributes
calculated as the averages of the values of the attributes of their
vertices: its name is the base name of the data source, followed by
“_e” (for Elements).</p></li>
</ul>
<p>Finally, either the number of the time step, or the calculated date of
the time step (based on the starting date and the number of seconds
elapsed), is added to the name. A data source in a file called Results
may therefore be read as several layers:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Results_p2014_05_01_20_00_00</span></code>, meaning that the layers holds the
attributes for the nodes and that the results hold for the time step
at 8:00 PM, on May 1st, 2014;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Results_e2014_05_01_20_00_00</span></code>, meaning that the layers holds the
attributes for the elements and that the results hold for the time
step at 8:00 PM, on May 1st, 2014;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Results_p2014_05_01_20_15_00</span></code>, meaning that the layers holds the
attributes for the elements and that the results hold for the time
step at 8:15 PM, on May 1st, 2014;</p></li>
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="constraints-on-layers">
<h3>Constraints on layers<a class="headerlink" href="#constraints-on-layers" title="Permalink to this headline">¶</a></h3>
<p>Because of the <a class="reference external" href="#format">format of the Selafin file</a>, the layers in a
single Selafin datasource are not independent from each other. Changing
one layer will most certainly have side effects on all other layers. The
driver updates all the layers to match the constraints:</p>
<ul class="simple">
<li><p>All the point layers have the same number of features. When a feature
is added or removed in one layer, it is also added or removed in all
other layers.</p></li>
<li><p>Features in different point layers share the same geometry. When the
position of one point is changed, it is also changed in all other
layers.</p></li>
<li><p>All the element layers have the same number of features. When a
feature is added or removed in one layer, it is also added or removed
in all other layers.</p></li>
<li><p>All the polygons in element layers have the same number of vertices.
The number of vertices is fixed when the first feature is added to an
element layer, and can not be changed afterwards without recreating
the datasource from scratch.</p></li>
<li><p>Features in different element layers share the same geometry. When an
element is added or removed in one layer, it is also added or removed
in all other layers.</p></li>
<li><p>Every vertex of every feature in an element layer has a corresponding
point feature in the point layers. When an element feature is added,
if its vertices do not exist yet, they are created in the point
layers.</p></li>
<li><p>Points and elements layers only support attributes of type “REAL”.
The format of real numbers (width and precision) can not be changed.</p></li>
</ul>
</div>
</div>
<div class="section" id="layer-filtering-specification">
<h2>Layer filtering specification<a class="headerlink" href="#layer-filtering-specification" title="Permalink to this headline">¶</a></h2>
<p>As a single Selafin files may hold millions of layers, and the user is
generally interested in only a few of them, the driver supports
syntactic sugar to filter the layers before they are read.</p>
<p>When the datasource is specified, it may be followed immediately by a
<em>layer filtering specification.</em>, as in <code class="docutils literal notranslate"><span class="pre">Results[0:10]</span></code>. The effects
of the layer filtering specification is to indicate which time steps
shall be loaded from all Selafin files.</p>
<p>The layer filtering specification is a comma-separated sequence of range
specifications, delimited by square brackets and maybe preceded by the
character ‘e’ or ‘p’. The effect of characters ‘e’ and ‘p’ is to select
respectively either only elements or only nodes. If no character is
added, both nodes and elements are selected. Each range specification
is:</p>
<ul class="simple">
<li><p>either a single number, representing one single time step (whose
numbers start with 0),</p></li>
<li><p>or a set of two numbers separated by a colon: in that case, all the
time steps between and including those two numbers are selected; if
the first number is missing, the range starts from the beginning of
the file (first time step); if the second number is missing, the
range goes to the end of the file (last time step);</p></li>
</ul>
<p>Numbers can also be negative. In this case, they are counted from the
end of the file, -1 being the last time step.</p>
<p>Some examples of layer filtering specifications:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>[0]</p></td>
<td><p>First time step only, but return both points and elements</p></td>
</tr>
<tr class="row-even"><td><p>[e:9]</p></td>
<td><p>First 10 time steps only, and only layers with elements</p></td>
</tr>
<tr class="row-odd"><td><p>[p-4:]</p></td>
<td><p>Last 4 time steps only, and only layers with nodes</p></td>
</tr>
<tr class="row-even"><td><p>[3,10,-2:-1]</p></td>
<td><p>4<sup>th</sup>, 11<sup>th</sup>, and last two time steps, for both nodes and elements</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="datasource-creation-options">
<h2>Datasource creation options<a class="headerlink" href="#datasource-creation-options" title="Permalink to this headline">¶</a></h2>
<p>Datasource creation options can be specified with the “<code class="docutils literal notranslate"><span class="pre">-dsco</span></code>” flag
in ogr2ogr.</p>
<dl class="simple">
<dt>TITLE</dt><dd><p>Title of the datasource, stored in the Selafin file. The title must
not hold more than 72 characters. If it is longer, it will be
truncated to fit in the file.</p>
</dd>
<dt>DATE</dt><dd><p>Starting date of the simulation. Each layer in a Selafin file is
characterized by a date, counted in seconds since a reference date.
This option allows providing the reference date. The format of this
field must be YYYY-MM-DD_hh:mm:ss. The format does not mention the
time zone.</p>
</dd>
</dl>
<p>An example of datasource creation option is:
<code class="docutils literal notranslate"><span class="pre">-dsco</span> <span class="pre">TITLE=&quot;My</span> <span class="pre">simulation&quot;</span> <span class="pre">-dsco</span> <span class="pre">DATE=2014-05-01_10:00:00</span></code>.</p>
</div>
<div class="section" id="layer-creation-options">
<h2>Layer creation options<a class="headerlink" href="#layer-creation-options" title="Permalink to this headline">¶</a></h2>
<p>Layer creation options can be specified with the “<code class="docutils literal notranslate"><span class="pre">-lco</span></code>” flag in
ogr2ogr.</p>
<dl class="simple">
<dt>DATE</dt><dd><p>Date of the time step relative to the starting date of the simulation
(see <a class="reference external" href="#DCO">Datasource creation options</a>). This is a single
floating-point value giving the number of seconds since the starting
date.</p>
</dd>
</dl>
<p>An example of datasource creation option is: <code class="docutils literal notranslate"><span class="pre">-lco</span> <span class="pre">DATE=24000</span></code>.</p>
</div>
<div class="section" id="notes-about-the-creation-and-the-update-of-a-selafin-datasource">
<h2>Notes about the creation and the update of a Selafin datasource<a class="headerlink" href="#notes-about-the-creation-and-the-update-of-a-selafin-datasource" title="Permalink to this headline">¶</a></h2>
<p>The driver supports creating and writing to Selafin datasources, but
there are some caveats when doing so.</p>
<p>When a new datasource is created, it does not contain any layer, feature
or attribute.</p>
<p>When a new layer is created, it automatically inherits the same number
of features and attributes as the other layers of the same type (points
or elements) already in the datasource. The features inherit the same
geometry as their corresponding ones in other layers. The attributes are
set to 0. If there was no layer in the datasource yet, the new layer is
created with no feature and attribute.In any case, when a new layer is
created, two layers are actually added: one for points and one for
elements.</p>
<p>New features and attributes can be added to the layers or removed. The
behavior depends on the type of layer (points or elements). The
following table explains the behavior of the driver in the different
cases.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 5%" />
<col style="width: 25%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Points layers</p></th>
<th class="head"><p>Element layers</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Change the geometry of a feature</p></td>
<td><p>The coordinates of the point are changed in the current layer and all other layers in the datasource.</p></td>
<td><p>The coordinates of all the vertices of the element are changed in the current layer and all other layers in the datasource. It is not possible to change the number of vertices. The order of the vertices matters.</p></td>
</tr>
<tr class="row-odd"><td><p>Change the attributes of a feature</p></td>
<td><p>The attributes of the point are changed in the current layer only.</p></td>
<td><p>No effect.</p></td>
</tr>
<tr class="row-even"><td><p>Add a new feature</p></td>
<td><p>A new point is added at the end of the list of features, for this layer and all other layers. Its attributes are set to the values of the new feature.</p></td>
<td><p>The operation is only allowed if the new feature has the same number of vertices as the other features in the layer. The vertices are checked to see if they currently exist in the set of points. A vertex is considered equal to a point if its distance is less than some maximum distance, approximately equal to 1/1000<sup>th</sup> of the average distance between two points in the points layers. When a corresponding point is found, it is used as a vertex for the element. If no point is found, a new is created in all associated layers.</p></td>
</tr>
<tr class="row-odd"><td><p>Delete a feature</p></td>
<td><p>The point is removed from the current layer and all point layers in the datasource. All elements using this point as a vertex are also removed from all element layers in the datasource.</p></td>
<td><p>The element is removed from the current layer and all element layers in the datasource.</p></td>
</tr>
</tbody>
</table>
<p>Typically, this implementation of operations is exactly what you’ll
expect. For example, ogr2ogr can be used to reproject the file without
changing the inner link between points and elements.</p>
<p>It should be noted that update operations on Selafin datasources are
very slow. This is because the format does no allow for quick insertions
or deletion of features and the file must be recreated for each
operation.</p>
</div>
<div class="section" id="vsi-virtual-file-system-api-support">
<h2>VSI Virtual File System API support<a class="headerlink" href="#vsi-virtual-file-system-api-support" title="Permalink to this headline">¶</a></h2>
<p>The driver supports reading and writing to files managed by VSI Virtual
File System API, which include “regular” files, as well as files in the
/vsizip/ (read-write) , /vsigzip/ (read-only) , /vsicurl/ (read-only)
domains.</p>
</div>
<div class="section" id="other-notes">
<h2>Other notes<a class="headerlink" href="#other-notes" title="Permalink to this headline">¶</a></h2>
<p>There is no SRS specification in the Selafin standard. The
implementation of SRS is an addition of the driver and stores the SRS in
an unused data field in the file. Future software using the Selafin
standard may use this field and break the SRS specification. In this
case, Selafin files will still be readable by the driver, but their
writing will overwrite a value which may have another purpose.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shapefile.html" class="btn btn-neutral float-right" title="ESRI Shapefile / DBF" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="segy.html" class="btn btn-neutral float-left" title="SEG-Y / SEGY" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2020 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>