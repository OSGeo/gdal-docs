

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OSM - OpenStreetMap XML and PBF &mdash; GDAL  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://gdal.orgdrivers/vector/osm.html"/>
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/gdal.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PDF – Geospatial PDF" href="pdf.html" />
    <link rel="prev" title="ESRI File Geodatabase (OpenFileGDB)" href="openfilegdb.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/gdalicon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programs/index.html">Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../raster/index.html">Raster drivers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Vector drivers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aeronavfaa.html">Aeronav FAA</a></li>
<li class="toctree-l2"><a class="reference internal" href="amigocloud.html">AmigoCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="ao.html">ESRI ArcObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="arcgen.html">ARCGEN - Arc/Info Generate</a></li>
<li class="toctree-l2"><a class="reference internal" href="avcbin.html">Arc/Info Binary Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="avce00.html">Arc/Info E00 (ASCII) Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bna.html">BNA - Atlas BNA</a></li>
<li class="toctree-l2"><a class="reference internal" href="cad.html">CAD – AutoCAD DWG</a></li>
<li class="toctree-l2"><a class="reference internal" href="carto.html">Carto</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudant.html">Cloudant – Cloudant</a></li>
<li class="toctree-l2"><a class="reference internal" href="couchdb.html">CouchDB - CouchDB/GeoCouch</a></li>
<li class="toctree-l2"><a class="reference internal" href="csv.html">Comma Separated Value (.csv)</a></li>
<li class="toctree-l2"><a class="reference internal" href="csw.html">CSW - OGC CSW (Catalog Service for the Web)</a></li>
<li class="toctree-l2"><a class="reference internal" href="db2.html">DB2 Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="dgn.html">Microstation DGN</a></li>
<li class="toctree-l2"><a class="reference internal" href="dgnv8.html">Microstation DGN v8</a></li>
<li class="toctree-l2"><a class="reference internal" href="dods.html">DODS/OPeNDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="dwg.html">AutoCAD DWG</a></li>
<li class="toctree-l2"><a class="reference internal" href="dxf.html">AutoCAD DXF</a></li>
<li class="toctree-l2"><a class="reference internal" href="eeda.html">Google Earth Engine Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="edigeo.html">EDIGEO</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticsearch.html">Elasticsearch: Geographically Encoded Objects for Elasticsearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="esrijson.html">ESRIJSON / FeatureService driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="filegdb.html">ESRI File Geodatabase (FileGDB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flatgeobuf.html">FlatGeobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="fme.html">FMEObjects Gateway</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoconcept.html">GeoConcept text export</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojson.html">GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="geojsonseq.html">GeoJSONSeq: sequence of GeoJSON features</a></li>
<li class="toctree-l2"><a class="reference internal" href="geomedia.html">Geomedia MDB database</a></li>
<li class="toctree-l2"><a class="reference internal" href="georss.html">GeoRSS : Geographically Encoded Objects for RSS feeds</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmlas.html">GMLAS - Geography Markup Language (GML) driven by application schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="gml.html">GML - Geography Markup Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmt.html">GMT ASCII Vectors (.gmt)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpkg.html">GPKG – GeoPackage vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpsbabel.html">GPSBabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpx.html">GPX - GPS Exchange Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="grass.html">GRASS Vector Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="gtm.html">GTM - GPS TrackMaker</a></li>
<li class="toctree-l2"><a class="reference internal" href="htf.html">HTF - Hydrographic Transfer Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="idb.html">IDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="idrisi.html">Idrisi Vector (.VCT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ili.html">“INTERLIS 1” and “INTERLIS 2” drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ingres.html">INGRES</a></li>
<li class="toctree-l2"><a class="reference internal" href="jml.html">JML: OpenJUMP JML format</a></li>
<li class="toctree-l2"><a class="reference internal" href="kml.html">KML - Keyhole Markup Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="libkml.html">LIBKML Driver (.kml .kmz)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mapml.html">MapML</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdb.html">Access MDB databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="mitab.html">MapInfo TAB and MIF/MID</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodb.html">MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodbv3.html">MongoDBv3</a></li>
<li class="toctree-l2"><a class="reference internal" href="mssqlspatial.html">MSSQLSpatial - Microsoft SQL Server Spatial Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="mvt.html">MVT: Mapbox Vector Tiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="mysql.html">MySQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="nas.html">NAS - ALKIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="netcdf.html">NetCDF: Network Common Data Form - Vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngw.html">NGW – NextGIS Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="ntf.html">UK .NTF</a></li>
<li class="toctree-l2"><a class="reference internal" href="oapif.html">OGC API - Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="oci.html">Oracle Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="odbc.html">ODBC RDBMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="ods.html">ODS - Open Document Spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="ogdi.html">OGDI Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="openair.html">OpenAir - OpenAir Special Use Airspace Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="openfilegdb.html">ESRI File Geodatabase (OpenFileGDB)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OSM - OpenStreetMap XML and PBF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#driver-capabilities">Driver capabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#other-tags-field">“other_tags” field</a></li>
<li class="toctree-l4"><a class="reference internal" href="#all-tags-field">“all_tags” field</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#internal-working-and-performance-tweaking">Internal working and performance tweaking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interleaved-reading">Interleaved reading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spatial-filtering">Spatial filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-osm-bz2-files-and-or-online-files">Reading .osm.bz2 files and/or online files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#open-options">Open options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pdf.html">PDF – Geospatial PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="pds.html">PDS - Planetary Data Systems TABLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgdump.html">PostgreSQL SQL Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="pgeo.html">ESRI Personal GeoDatabase</a></li>
<li class="toctree-l2"><a class="reference internal" href="pg.html">PostgreSQL / PostGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="plscenes.html">PLScenes (Planet Labs Scenes/Catalog API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="s57.html">IHO S-57 (ENC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sde.html">ESRI ArcSDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdts.html">SDTS</a></li>
<li class="toctree-l2"><a class="reference internal" href="segukooa.html">SEG-P1 / UKOOA P1/90</a></li>
<li class="toctree-l2"><a class="reference internal" href="segy.html">SEG-Y / SEGY</a></li>
<li class="toctree-l2"><a class="reference internal" href="selafin.html">Selafin files</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapefile.html">ESRI Shapefile / DBF</a></li>
<li class="toctree-l2"><a class="reference internal" href="sosi.html">Norwegian SOSI Standard</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqlite.html">SQLite / Spatialite RDBMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="sua.html">SUA - Tim Newport-Peace’s Special Use Airspace Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="svg.html">SVG - Scalable Vector Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="sxf.html">Storage and eXchange Format - SXF</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiger.html">U.S. Census TIGER/Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="topojson.html">TopoJSON driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="vdv.html">VDV - VDV-451/VDV-452/INTREST Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vfk.html">VFK - Czech Cadastral Exchange Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vrt.html">VRT – Virtual Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="walk.html">Walk - Walk Spatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="wasp.html">WAsP - WAsP .map format</a></li>
<li class="toctree-l2"><a class="reference internal" href="wfs.html">WFS - OGC WFS service</a></li>
<li class="toctree-l2"><a class="reference internal" href="xls.html">XLS - MS Excel format</a></li>
<li class="toctree-l2"><a class="reference internal" href="xlsx.html">XLSX - MS Office Open XML spreadsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="xplane.html">X-Plane/Flightgear aeronautical data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">How to contribute?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GDAL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html"> GDAL  documentation </a> &raquo;</li>
      
          <li><a href="index.html">Vector drivers</a> &raquo;</li>
      
      <li>OSM - OpenStreetMap XML and PBF</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/edit//master/gdal/doc/source/drivers/vector/osm.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="pdf.html" class="btn btn-neutral float-right" title="PDF – Geospatial PDF" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="openfilegdb.html" class="btn btn-neutral float-left" title="ESRI File Geodatabase (OpenFileGDB)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="osm-openstreetmap-xml-and-pbf">
<span id="vector-osm"></span><h1>OSM - OpenStreetMap XML and PBF<a class="headerlink" href="#osm-openstreetmap-xml-and-pbf" title="Permalink to this headline">¶</a></h1>
<div class="admonition shortname" id="shortname-0">
<p class="admonition-title">Driver short name</p>
<p>OSM</p>
</div>
<div class="admonition build_dependencies" id="build_dependencies-0">
<p class="admonition-title">Build dependencies</p>
<p>libsqlite3 (and libexpat for OSM XML)</p>
</div>
<p>This driver reads OpenStreetMap files, in .osm (XML based) and .pbf
(optimized binary) formats.</p>
<p>The driver is available if GDAL is built with SQLite support and, for
.osm XML files, with Expat support.</p>
<p>The filenames must end with .osm or .pbf extension.</p>
<p>The driver will categorize features into 5 layers :</p>
<ul class="simple">
<li><p><strong>points</strong> : “node” features that have significant tags attached.</p></li>
<li><p><strong>lines</strong> : “way” features that are recognized as non-area.</p></li>
<li><p><strong>multilinestrings</strong> : “relation” features that form a
multilinestring(type = ‘multilinestring’ or type = ‘route’).</p></li>
<li><p><strong>multipolygons</strong> : “relation” features that form a multipolygon
(type = ‘multipolygon’ or type = ‘boundary’), and “way” features that
are recognized as area.</p></li>
<li><p><strong>other_relations</strong> : “relation” features that do not belong to the
above 2 layers.</p></li>
</ul>
<div class="section" id="driver-capabilities">
<h2>Driver capabilities<a class="headerlink" href="#driver-capabilities" title="Permalink to this headline">¶</a></h2>
<div class="admonition supports_georeferencing" id="supports_georeferencing-0">
<p class="admonition-title">Supports Georeferencing</p>
<p>This driver supports georeferencing</p>
</div>
<div class="admonition supports_virtualio" id="supports_virtualio-0">
<p class="admonition-title">Supports VirtualIO</p>
<p>This driver supports <a class="reference internal" href="../../user/virtual_file_systems.html#virtual-file-systems"><span class="std std-ref">virtual I/O operations (/vsimem/, etc.)</span></a></p>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>In the <em>data</em> folder of the GDAL distribution, you can find a
<a class="reference external" href="https://github.com/OSGeo/gdal/blob/master/gdal/data/osmconf.ini">osmconf.ini</a>
file that can be customized to fit your needs. You can also define an
alternate path with the OSM_CONFIG_FILE configuration option.</p>
<p>The customization is essentially which OSM attributes and keys should be
translated into OGR layer fields.</p>
<p>Starting with GDAL 2.0, fields can be computed with SQL expressions
(evaluated by SQLite engine) from other fields/tags. For example to
compute the z_order attribute.</p>
<div class="section" id="other-tags-field">
<h3>“other_tags” field<a class="headerlink" href="#other-tags-field" title="Permalink to this headline">¶</a></h3>
<p>When keys are not strictly identified in the <em>osmconf.ini</em> file, the
key/value pair is appended in a “other_tags” field, with a syntax
compatible with the PostgreSQL HSTORE type. See the <em>COLUMN_TYPES</em> layer
creation option of the <a class="reference internal" href="pg.html#vector-pg"><span class="std std-ref">PG driver</span></a>.</p>
<p>For example :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">PostgreSQL</span> <span class="s2">&quot;PG:dbname=osm&quot;</span> <span class="n">test</span><span class="o">.</span><span class="n">pbf</span> <span class="o">-</span><span class="n">lco</span> <span class="n">COLUMN_TYPES</span><span class="o">=</span><span class="n">other_tags</span><span class="o">=</span><span class="n">hstore</span>
</pre></div>
</div>
</div>
<div class="section" id="all-tags-field">
<h3>“all_tags” field<a class="headerlink" href="#all-tags-field" title="Permalink to this headline">¶</a></h3>
<p>Similar to “other_tags”, except that it contains both keys specifically
identified to be reported as dedicated fields, as well as other keys.</p>
<p>“all_tags” is disabled by default, and when enabled, it is exclusive
with “other_tags”.</p>
</div>
</div>
<div class="section" id="internal-working-and-performance-tweaking">
<h2>Internal working and performance tweaking<a class="headerlink" href="#internal-working-and-performance-tweaking" title="Permalink to this headline">¶</a></h2>
<p>The driver will use an internal SQLite database to resolve geometries.
If that database remains under 100 MB it will reside in RAM. If it grows
above, it will be written in a temporary file on disk. By default, this
file will be written in the current directory, unless you define the
CPL_TMPDIR configuration option. The 100 MB default threshold can be
adjusted with the OSM_MAX_TMPFILE_SIZE configuration option (value in
MB).</p>
<p>For indexation of nodes, a custom mechanism not relying on SQLite is
used by default (indexation of ways to solve relations is still relying
on SQLite). It can speed up operations significantly. However, in some
situations (non increasing node ids, or node ids not in expected range),
it might not work and the driver will output an error message suggesting
to relaunch by defining the OSM_USE_CUSTOM_INDEXING configuration option
to NO.</p>
<p>When custom indexing is used (default case), the OSM_COMPRESS_NODES
configuration option can be set to YES (the default is NO). This option
might be turned on to improve performances when I/O access is the
limiting factor (typically the case of rotational disk), and will be
mostly efficient for country-sized OSM extracts where compression rate
can go up to a factor of 3 or 4, and help keep the node DB to a size
that fit in the OS I/O caches. For whole planet file, the effect of this
option will be less efficient. This option consumes addionnal 60 MB of
RAM.</p>
</div>
<div class="section" id="interleaved-reading">
<h2>Interleaved reading<a class="headerlink" href="#interleaved-reading" title="Permalink to this headline">¶</a></h2>
<p>Due to the nature of OSM files and how the driver works internally, the
default reading mode that works per-layer might not work correctly,
because too many features will accumulate in the layers before being
consumed by the user application.</p>
<p>Starting with GDAL 2.2, applications should use the
GDALDataset::GetNextFeature() API to iterate over features in the order
they are produced.</p>
<p>For earlier versions, for large files, applications should set the
OGR_INTERLEAVED_READING=YES configuration option to turn on a special
reading mode where the following reading pattern must be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span> <span class="n">bHasLayersNonEmpty</span><span class="p">;</span>
<span class="n">do</span>
<span class="p">{</span>
    <span class="n">bHasLayersNonEmpty</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span> <span class="nb">int</span> <span class="n">iLayer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iLayer</span> <span class="o">&lt;</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">GetLayerCount</span><span class="p">();</span> <span class="n">iLayer</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">OGRLayer</span> <span class="o">*</span><span class="n">poLayer</span> <span class="o">=</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">GetLayer</span><span class="p">(</span><span class="n">iLayer</span><span class="p">);</span>

        <span class="n">OGRFeature</span><span class="o">*</span> <span class="n">poFeature</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">poFeature</span> <span class="o">=</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">())</span> <span class="o">!=</span> <span class="n">NULL</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">bHasLayersNonEmpty</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
            <span class="n">OGRFeature</span><span class="p">::</span><span class="n">DestroyFeature</span><span class="p">(</span><span class="n">poFeature</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">while</span><span class="p">(</span> <span class="n">bHasLayersNonEmpty</span> <span class="p">);</span>
</pre></div>
</div>
<p>Note : the ogr2ogr application has been modified to use that
OGR_INTERLEAVED_READING mode without any particular user action.</p>
</div>
<div class="section" id="spatial-filtering">
<h2>Spatial filtering<a class="headerlink" href="#spatial-filtering" title="Permalink to this headline">¶</a></h2>
<p>Due to way .osm or .pbf files are structured and the parsing of the file
is done, for efficiency reasons, a spatial filter applied on the points
layer will also affect other layers. This may result in lines or
polygons that have missing vertices.</p>
<p>To improve this, a possibility is using a larger spatial filter with
some buffer for the points layer, and then post-process the output to
apply the desired filter. This would not work however if a polygon has
vertices very far away from the interest area. In which case full
conversion of the file to another format, and filtering of the resulting
lines or polygons layers would be needed.</p>
</div>
<div class="section" id="reading-osm-bz2-files-and-or-online-files">
<h2>Reading .osm.bz2 files and/or online files<a class="headerlink" href="#reading-osm-bz2-files-and-or-online-files" title="Permalink to this headline">¶</a></h2>
<p>.osm.bz2 are not natively recognized, however you can process them (on
Unix), with the following command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bzcat</span> <span class="n">my</span><span class="o">.</span><span class="n">osm</span><span class="o">.</span><span class="n">bz2</span> <span class="o">|</span> <span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">SQLite</span> <span class="n">my</span><span class="o">.</span><span class="n">sqlite</span> <span class="o">/</span><span class="n">vsistdin</span><span class="o">/</span>
</pre></div>
</div>
<p>You can convert a .osm or .pbf file without downloading it :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">some</span><span class="o">.</span><span class="n">pbf</span> <span class="o">|</span> <span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">SQLite</span> <span class="n">my</span><span class="o">.</span><span class="n">sqlite</span> <span class="o">/</span><span class="n">vsistdin</span><span class="o">/</span>

<span class="ow">or</span>

<span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">SQLite</span> <span class="n">my</span><span class="o">.</span><span class="n">sqlite</span> <span class="o">/</span><span class="n">vsicurl_streaming</span><span class="o">/</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">some</span><span class="o">.</span><span class="n">pbf</span> <span class="o">-</span><span class="n">progress</span>
</pre></div>
</div>
<p>And to combine the above steps :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">some</span><span class="o">.</span><span class="n">osm</span><span class="o">.</span><span class="n">bz2</span> <span class="o">|</span> <span class="n">bzcat</span> <span class="o">|</span> <span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">SQLite</span> <span class="n">my</span><span class="o">.</span><span class="n">sqlite</span> <span class="o">/</span><span class="n">vsistdin</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="open-options">
<h2>Open options<a class="headerlink" href="#open-options" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>CONFIG_FILE=filename</strong>: (GDAL &gt;=2.0) Configuration filename.
Defaults to {GDAL_DATA}/osmconf.ini.</p></li>
<li><p><strong>USE_CUSTOM_INDEXING=YES/NO</strong>: (GDAL &gt;=2.0) Whether to enable custom
indexing. Defaults to YES.</p></li>
<li><p><strong>COMPRESS_NODES=YES/NO</strong>: (GDAL &gt;=2.0) Whether to compress nodes in
temporary DB. Defaults to NO.</p></li>
<li><p><strong>MAX_TMPFILE_SIZE=int_val</strong>: (GDAL &gt;=2.0) Maximum size in MB of
in-memory temporary file. If it exceeds that value, it will go to
disk. Defaults to 100.</p></li>
<li><p><strong>INTERLEAVED_READING=YES/NO</strong>: (GDAL &gt;=2.0) Whether to enable
interleaved reading. Defaults to NO.</p></li>
</ul>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.openstreetmap.org/">OpenStreetMap home page</a></p></li>
<li><p><a class="reference external" href="http://wiki.openstreetmap.org/wiki/OSM_XML">OSM XML Format
description</a></p></li>
<li><p><a class="reference external" href="http://wiki.openstreetmap.org/wiki/PBF_Format">OSM PBF Format
description</a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pdf.html" class="btn btn-neutral float-right" title="PDF – Geospatial PDF" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="openfilegdb.html" class="btn btn-neutral float-left" title="ESRI File Geodatabase (OpenFileGDB)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2020 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>