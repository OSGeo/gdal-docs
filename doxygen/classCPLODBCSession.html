<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GDAL: CPLODBCSession Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GDAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classCPLODBCSession-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CPLODBCSession Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A class representing an ODBC database session.  
 <a href="classCPLODBCSession.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cpl__odbc_8h_source.html">cpl_odbc.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae720f606a1cdbe412a009e17dc51d39d"><td class="memItemLeft" align="right" valign="top"><a id="ae720f606a1cdbe412a009e17dc51d39d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#ae720f606a1cdbe412a009e17dc51d39d">CPLODBCSession</a> ()</td></tr>
<tr class="memdesc:ae720f606a1cdbe412a009e17dc51d39d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br /></td></tr>
<tr class="separator:ae720f606a1cdbe412a009e17dc51d39d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac802962a10b2677e3321bb241d7d8baa"><td class="memItemLeft" align="right" valign="top"><a id="ac802962a10b2677e3321bb241d7d8baa"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#ac802962a10b2677e3321bb241d7d8baa">~CPLODBCSession</a> ()</td></tr>
<tr class="memdesc:ac802962a10b2677e3321bb241d7d8baa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:ac802962a10b2677e3321bb241d7d8baa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25f8f6b0370dafc0e1fb3435388fdef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#aa25f8f6b0370dafc0e1fb3435388fdef">EstablishSession</a> (const char *pszDSN, const char *pszUserid, const char *pszPassword)</td></tr>
<tr class="memdesc:aa25f8f6b0370dafc0e1fb3435388fdef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to database and logon.  <a href="#aa25f8f6b0370dafc0e1fb3435388fdef">More...</a><br /></td></tr>
<tr class="separator:aa25f8f6b0370dafc0e1fb3435388fdef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a7f6353e992d35569c6a963c40a0cbb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#a3a7f6353e992d35569c6a963c40a0cbb">GetLastError</a> ()</td></tr>
<tr class="memdesc:a3a7f6353e992d35569c6a963c40a0cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the last ODBC error message.  <a href="#a3a7f6353e992d35569c6a963c40a0cbb">More...</a><br /></td></tr>
<tr class="separator:a3a7f6353e992d35569c6a963c40a0cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2eb7cf0a477cf12d9fb72d61d244dca"><td class="memItemLeft" align="right" valign="top"><a id="aa2eb7cf0a477cf12d9fb72d61d244dca"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#aa2eb7cf0a477cf12d9fb72d61d244dca">ClearTransaction</a> ()</td></tr>
<tr class="memdesc:aa2eb7cf0a477cf12d9fb72d61d244dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear transaction. <br /></td></tr>
<tr class="separator:aa2eb7cf0a477cf12d9fb72d61d244dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9246dd84aa8d0362bff1bde049d722f"><td class="memItemLeft" align="right" valign="top"><a id="ae9246dd84aa8d0362bff1bde049d722f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#ae9246dd84aa8d0362bff1bde049d722f">BeginTransaction</a> ()</td></tr>
<tr class="memdesc:ae9246dd84aa8d0362bff1bde049d722f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin transaction. <br /></td></tr>
<tr class="separator:ae9246dd84aa8d0362bff1bde049d722f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af581a96ecb2ceb24c573fca164ac6396"><td class="memItemLeft" align="right" valign="top"><a id="af581a96ecb2ceb24c573fca164ac6396"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#af581a96ecb2ceb24c573fca164ac6396">CommitTransaction</a> ()</td></tr>
<tr class="memdesc:af581a96ecb2ceb24c573fca164ac6396"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit transaction. <br /></td></tr>
<tr class="separator:af581a96ecb2ceb24c573fca164ac6396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9550aa9d5faad39110d7d273d792b26"><td class="memItemLeft" align="right" valign="top"><a id="ad9550aa9d5faad39110d7d273d792b26"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#ad9550aa9d5faad39110d7d273d792b26">RollbackTransaction</a> ()</td></tr>
<tr class="memdesc:ad9550aa9d5faad39110d7d273d792b26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rollback transaction. <br /></td></tr>
<tr class="separator:ad9550aa9d5faad39110d7d273d792b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ec277504d4393bbc92a2fc0d4a6a15b"><td class="memItemLeft" align="right" valign="top"><a id="a0ec277504d4393bbc92a2fc0d4a6a15b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#a0ec277504d4393bbc92a2fc0d4a6a15b">IsInTransaction</a> ()</td></tr>
<tr class="memdesc:a0ec277504d4393bbc92a2fc0d4a6a15b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether a transaction is active. <br /></td></tr>
<tr class="separator:a0ec277504d4393bbc92a2fc0d4a6a15b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e9a403fa56f1d9781ceceb5c494b31"><td class="memItemLeft" align="right" valign="top"><a id="ad2e9a403fa56f1d9781ceceb5c494b31"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#ad2e9a403fa56f1d9781ceceb5c494b31">CloseSession</a> ()</td></tr>
<tr class="memdesc:ad2e9a403fa56f1d9781ceceb5c494b31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close session. <br /></td></tr>
<tr class="separator:ad2e9a403fa56f1d9781ceceb5c494b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296fa1c306c95293cd1c7c8327317e81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#a296fa1c306c95293cd1c7c8327317e81">Failed</a> (int, HSTMT=nullptr)</td></tr>
<tr class="memdesc:a296fa1c306c95293cd1c7c8327317e81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if a return code indicates failure, return TRUE if that is the case.  <a href="#a296fa1c306c95293cd1c7c8327317e81">More...</a><br /></td></tr>
<tr class="separator:a296fa1c306c95293cd1c7c8327317e81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e5be05aeee3152b5d08e9b9472ab157"><td class="memItemLeft" align="right" valign="top"><a id="a1e5be05aeee3152b5d08e9b9472ab157"></a>
HDBC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#a1e5be05aeee3152b5d08e9b9472ab157">GetConnection</a> ()</td></tr>
<tr class="memdesc:a1e5be05aeee3152b5d08e9b9472ab157"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return connection handle. <br /></td></tr>
<tr class="separator:a1e5be05aeee3152b5d08e9b9472ab157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad02872998f4a5ef8ae0d49a4c35e0996"><td class="memItemLeft" align="right" valign="top"><a id="ad02872998f4a5ef8ae0d49a4c35e0996"></a>
HENV&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCSession.html#ad02872998f4a5ef8ae0d49a4c35e0996">GetEnvironment</a> ()</td></tr>
<tr class="memdesc:ad02872998f4a5ef8ae0d49a4c35e0996"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return GetEnvironment handle. <br /></td></tr>
<tr class="separator:ad02872998f4a5ef8ae0d49a4c35e0996"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class representing an ODBC database session. </p>
<p>Includes error collection services. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa25f8f6b0370dafc0e1fb3435388fdef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25f8f6b0370dafc0e1fb3435388fdef">&#9670;&nbsp;</a></span>EstablishSession()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CPLODBCSession::EstablishSession </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszDSN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszUserid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszPassword</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect to database and logon. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pszDSN</td><td>The name of the DSN being used to connect. This is not optional.</td></tr>
    <tr><td class="paramname">pszUserid</td><td>the userid to logon as, may be NULL if not not required, or provided by the DSN.</td></tr>
    <tr><td class="paramname">pszPassword</td><td>the password to logon with. May be NULL if not required or provided by the DSN.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success or FALSE on failure. Call <a class="el" href="classCPLODBCSession.html#a3a7f6353e992d35569c6a963c40a0cbb" title="Returns the last ODBC error message. ">GetLastError()</a> to get details on failure. </dd></dl>

</div>
</div>
<a id="a296fa1c306c95293cd1c7c8327317e81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296fa1c306c95293cd1c7c8327317e81">&#9670;&nbsp;</a></span>Failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CPLODBCSession::Failed </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nRetCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HSTMT&#160;</td>
          <td class="paramname"><em>hStmt</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test if a return code indicates failure, return TRUE if that is the case. </p>
<p>Also update error text.</p>
<p>ODBC error messages are reported in the following format: [SQLState]ErrorMessage(NativeErrorCode)</p>
<p>Multiple error messages are delimeted by ",". </p>

</div>
</div>
<a id="a3a7f6353e992d35569c6a963c40a0cbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a7f6353e992d35569c6a963c40a0cbb">&#9670;&nbsp;</a></span>GetLastError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * CPLODBCSession::GetLastError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the last ODBC error message. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to an internal buffer with the error message in it. Do not free or alter. Will be an empty (but not NULL) string if there is no pending error info. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cpl__odbc_8h_source.html">cpl_odbc.h</a></li>
<li>cpl_odbc.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
