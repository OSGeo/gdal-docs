<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GDAL: CPLODBCDriverInstaller Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GDAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classCPLODBCDriverInstaller-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CPLODBCDriverInstaller Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A class providing functions to install or remove ODBC driver.  
 <a href="classCPLODBCDriverInstaller.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cpl__odbc_8h_source.html">cpl_odbc.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5c28df1aa17c380a53effdb2aa0bd2fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCDriverInstaller.html#a5c28df1aa17c380a53effdb2aa0bd2fb">InstallDriver</a> (const char *pszDriver, const char *pszPathIn, WORD fRequest=ODBC_INSTALL_COMPLETE)</td></tr>
<tr class="memdesc:a5c28df1aa17c380a53effdb2aa0bd2fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Installs ODBC driver or updates definition of already installed driver.  <a href="#a5c28df1aa17c380a53effdb2aa0bd2fb">More...</a><br /></td></tr>
<tr class="separator:a5c28df1aa17c380a53effdb2aa0bd2fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c5738b0b592c05653d79a834bb0b32"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCDriverInstaller.html#a79c5738b0b592c05653d79a834bb0b32">RemoveDriver</a> (const char *pszDriverName, int fRemoveDSN=FALSE)</td></tr>
<tr class="memdesc:a79c5738b0b592c05653d79a834bb0b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes or changes information about the driver from the Odbcinst.ini entry in the system information.  <a href="#a79c5738b0b592c05653d79a834bb0b32">More...</a><br /></td></tr>
<tr class="separator:a79c5738b0b592c05653d79a834bb0b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1daae36cb9629cca286ca4a019f961fb"><td class="memItemLeft" align="right" valign="top"><a id="a1daae36cb9629cca286ca4a019f961fb"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCDriverInstaller.html#a1daae36cb9629cca286ca4a019f961fb">GetUsageCount</a> () const</td></tr>
<tr class="memdesc:a1daae36cb9629cca286ca4a019f961fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The usage count of the driver after this function has been called. <br /></td></tr>
<tr class="separator:a1daae36cb9629cca286ca4a019f961fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5cd07b632c608be0e18d79bf97baff0"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCDriverInstaller.html#af5cd07b632c608be0e18d79bf97baff0">GetPathOut</a> () const</td></tr>
<tr class="memdesc:af5cd07b632c608be0e18d79bf97baff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Path of the target directory where the driver should be installed.  <a href="#af5cd07b632c608be0e18d79bf97baff0">More...</a><br /></td></tr>
<tr class="separator:af5cd07b632c608be0e18d79bf97baff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4e88ade82d80bfdfd443bd4ea6a1749"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCDriverInstaller.html#ac4e88ade82d80bfdfd443bd4ea6a1749">GetLastError</a> () const</td></tr>
<tr class="memdesc:ac4e88ade82d80bfdfd443bd4ea6a1749"><td class="mdescLeft">&#160;</td><td class="mdescRight">If InstallDriver returns FALSE, then GetLastError then error message can be obtained by calling this function.  <a href="#ac4e88ade82d80bfdfd443bd4ea6a1749">More...</a><br /></td></tr>
<tr class="separator:ac4e88ade82d80bfdfd443bd4ea6a1749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec45a97dbdecc79cc3f742bcd017220"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCPLODBCDriverInstaller.html#afec45a97dbdecc79cc3f742bcd017220">GetLastErrorCode</a> () const</td></tr>
<tr class="memdesc:afec45a97dbdecc79cc3f742bcd017220"><td class="mdescLeft">&#160;</td><td class="mdescRight">If InstallDriver returns FALSE, then GetLastErrorCode then error code can be obtained by calling this function.  <a href="#afec45a97dbdecc79cc3f742bcd017220">More...</a><br /></td></tr>
<tr class="separator:afec45a97dbdecc79cc3f742bcd017220"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class providing functions to install or remove ODBC driver. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ac4e88ade82d80bfdfd443bd4ea6a1749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4e88ade82d80bfdfd443bd4ea6a1749">&#9670;&nbsp;</a></span>GetLastError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* CPLODBCDriverInstaller::GetLastError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If InstallDriver returns FALSE, then GetLastError then error message can be obtained by calling this function. </p>
<p>Internally, it calls ODBC's SQLInstallerError function. </p>

</div>
</div>
<a id="afec45a97dbdecc79cc3f742bcd017220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afec45a97dbdecc79cc3f742bcd017220">&#9670;&nbsp;</a></span>GetLastErrorCode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DWORD CPLODBCDriverInstaller::GetLastErrorCode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If InstallDriver returns FALSE, then GetLastErrorCode then error code can be obtained by calling this function. </p>
<p>Internally, it calls ODBC's SQLInstallerError function. See ODBC API Reference for possible error flags. </p>

</div>
</div>
<a id="af5cd07b632c608be0e18d79bf97baff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5cd07b632c608be0e18d79bf97baff0">&#9670;&nbsp;</a></span>GetPathOut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* CPLODBCDriverInstaller::GetPathOut </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Path of the target directory where the driver should be installed. </p>
<p>For details, see ODBC API Reference and lpszPathOut parameter of SQLInstallDriverEx </p>

</div>
</div>
<a id="a5c28df1aa17c380a53effdb2aa0bd2fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c28df1aa17c380a53effdb2aa0bd2fb">&#9670;&nbsp;</a></span>InstallDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CPLODBCDriverInstaller::InstallDriver </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszDriver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszPathIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>fRequest</em> = <code>ODBC_INSTALL_COMPLETE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Installs ODBC driver or updates definition of already installed driver. </p>
<p>Interanally, it calls ODBC's SQLInstallDriverEx function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pszDriver</td><td>- The driver definition as a list of keyword-value pairs describing the driver (See ODBC API Reference).</td></tr>
    <tr><td class="paramname">pszPathIn</td><td>- Full path of the target directory of the installation, or a null pointer (for unixODBC, NULL is passed).</td></tr>
    <tr><td class="paramname">fRequest</td><td>- The fRequest argument must contain one of the following values: ODBC_INSTALL_COMPLETE - (default) complete the installation request ODBC_INSTALL_INQUIRY - inquire about where a driver can be installed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE indicates success, FALSE if it fails. </dd></dl>

</div>
</div>
<a id="a79c5738b0b592c05653d79a834bb0b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c5738b0b592c05653d79a834bb0b32">&#9670;&nbsp;</a></span>RemoveDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CPLODBCDriverInstaller::RemoveDriver </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszDriverName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fRemoveDSN</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes or changes information about the driver from the Odbcinst.ini entry in the system information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pszDriverName</td><td>- The name of the driver as registered in the Odbcinst.ini key of the system information.</td></tr>
    <tr><td class="paramname">fRemoveDSN</td><td>- TRUE: Remove DSNs associated with the driver specified in lpszDriver. FALSE: Do not remove DSNs associated with the driver specified in lpszDriver.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns TRUE if it is successful, FALSE if it fails. If no entry exists in the system information when this function is called, the function returns FALSE. In order to obtain usage count value, call <a class="el" href="classCPLODBCDriverInstaller.html#a1daae36cb9629cca286ca4a019f961fb" title="The usage count of the driver after this function has been called. ">GetUsageCount()</a>. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cpl__odbc_8h_source.html">cpl_odbc.h</a></li>
<li>cpl_odbc.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
