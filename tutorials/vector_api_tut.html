

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Vector API tutorial &mdash; GDAL  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://gdal.orgtutorials/vector_api_tut.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/gdal.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Vector driver implementation tutorial" href="vector_driver_tut.html" />
    <link rel="prev" title="Multidimensional raster API tutorial" href="multidimensional_api_tut.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/gdalicon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programs/index.html">Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drivers/raster/index.html">Raster drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drivers/vector/index.html">Vector drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#raster">Raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#multidimensional-raster">Multidimensional raster</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#vector">Vector</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Vector API tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reading-from-ogr">Reading From OGR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-to-ogr">Writing To OGR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="vector_driver_tut.html">Vector driver implementation tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#geographic-network-model">Geographic Network Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#projections-and-spatial-reference-systems-tutorial-osr-ogrspatialreference">Projections and Spatial Reference Systems tutorial (OSR - OGRSpatialReference)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">How to contribute?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GDAL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html"> GDAL  documentation </a> &raquo;</li>
      
          <li><a href="index.html">Tutorials</a> &raquo;</li>
      
      <li>Vector API tutorial</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OSGeo/gdal/blob//master/gdal/doc/source/tutorials/vector_api_tut.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="vector_driver_tut.html" class="btn btn-neutral float-right" title="Vector driver implementation tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="multidimensional_api_tut.html" class="btn btn-neutral float-left" title="Multidimensional raster API tutorial" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vector-api-tutorial">
<span id="vector-api-tut"></span><h1>Vector API tutorial<a class="headerlink" href="#vector-api-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This document is intended to document using the OGR C++ classes to read
and write data from a file.  It is strongly advised that the read first
review the <a class="reference internal" href="../user/vector_data_model.html#vector-data-model"><span class="std std-ref">Vector Data Model</span></a> document describing
the key classes and their roles in OGR.</p>
<p>It also includes code snippets for the corresponding functions in C and Python.</p>
<div class="section" id="reading-from-ogr">
<h2>Reading From OGR<a class="headerlink" href="#reading-from-ogr" title="Permalink to this headline">¶</a></h2>
<p>For purposes of demonstrating reading with OGR, we will construct a small
utility for dumping point layers from an OGR data source to stdout in
comma-delimited format.</p>
<p>Initially it is necessary to register all the format drivers that are desired.
This is normally accomplished by calling <a class="reference internal" href="../api/raster_c_api.html#_CPPv415GDALAllRegisterv" title="GDALAllRegister"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALAllRegister()</span></code></a> which registers
all format drivers built into GDAL/OGR.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ogrsf_frmts.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>

<span class="p">{</span>
    <span class="n">GDALAllRegister</span><span class="p">();</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;gdal.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>

<span class="p">{</span>
    <span class="n">GDALAllRegister</span><span class="p">();</span>
</pre></div>
</div>
<p>Next we need to open the input OGR datasource.  Datasources can be files,
RDBMSes, directories full of files, or even remote web services depending on
the driver being used.  However, the datasource name is always a single
string.  In this case we are hardcoded to open a particular shapefile.
The second argument (GDAL_OF_VECTOR) tells the <a class="reference internal" href="../api/vector_c_api.html#_CPPv47OGROpenPKciP12OGRSFDriverH" title="OGROpen"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGROpen()</span></code></a> method
that we want a vector driver to be use and that don’t require update access.
On failure NULL is returned, and
we report an error.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">GDALDataset</span>       <span class="o">*</span><span class="n">poDS</span><span class="p">;</span>

<span class="n">poDS</span> <span class="o">=</span> <span class="p">(</span><span class="n">GDALDataset</span><span class="o">*</span><span class="p">)</span> <span class="n">GDALOpenEx</span><span class="p">(</span> <span class="s">&quot;point.shp&quot;</span><span class="p">,</span> <span class="n">GDAL_OF_VECTOR</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">poDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Open failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">GDALDatasetH</span> <span class="n">hDS</span><span class="p">;</span>

<span class="n">hDS</span> <span class="o">=</span> <span class="n">GDALOpenEx</span><span class="p">(</span> <span class="s">&quot;point.shp&quot;</span><span class="p">,</span> <span class="n">GDAL_OF_VECTOR</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">hDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Open failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A GDALDataset can potentially have many layers associated with it.  The
number of layers available can be queried with <a class="reference internal" href="../api/gdaldataset_cpp.html#_CPPv4N11GDALDataset13GetLayerCountEv" title="GDALDataset::GetLayerCount"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::GetLayerCount()</span></code></a>
and individual layers fetched by index using <a class="reference internal" href="../api/gdaldataset_cpp.html#_CPPv4N11GDALDataset8GetLayerEi" title="GDALDataset::GetLayer"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::GetLayer()</span></code></a>.
However, we will just fetch the layer by name.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRLayer</span>  <span class="o">*</span><span class="n">poLayer</span><span class="p">;</span>

<span class="n">poLayer</span> <span class="o">=</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">GetLayerByName</span><span class="p">(</span> <span class="s">&quot;point&quot;</span> <span class="p">);</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRLayerH</span> <span class="n">hLayer</span><span class="p">;</span>

<span class="n">hLayer</span> <span class="o">=</span> <span class="n">GDALDatasetGetLayerByName</span><span class="p">(</span> <span class="n">hDS</span><span class="p">,</span> <span class="s">&quot;point&quot;</span> <span class="p">);</span>
</pre></div>
</div>
<p>Now we want to start reading features from the layer.  Before we start we
could assign an attribute or spatial filter to the layer to restrict the set
of feature we get back, but for now we are interested in getting all features.</p>
<p>With GDAL 2.3 and C++11:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="p">(</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">poFeature</span><span class="p">:</span> <span class="n">poLayer</span> <span class="p">)</span>
<span class="p">{</span>
</pre></div>
</div>
<p>With GDAL 2.3 and C:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGR_FOR_EACH_FEATURE_BEGIN</span><span class="p">(</span><span class="n">hFeature</span><span class="p">,</span> <span class="n">hLayer</span><span class="p">)</span>
<span class="p">{</span>
</pre></div>
</div>
<p>If using older GDAL versions, while it isn’t strictly necessary in this
circumstance since we are starting fresh with the layer, it is often wise
to call <a class="reference internal" href="../api/ogrlayer_cpp.html#_CPPv4N8OGRLayer12ResetReadingEv" title="OGRLayer::ResetReading"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRLayer::ResetReading()</span></code></a> to ensure we are starting at the beginning of
the layer.  We iterate through all the features in the layer using
OGRLayer::GetNextFeature().  It will return NULL when we run out of features.</p>
<p>With GDAL &gt; 2.3 and C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span> <span class="o">*</span><span class="n">poFeature</span><span class="p">;</span>

<span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">poFeature</span> <span class="o">=</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
</pre></div>
</div>
<p>With GDAL &gt; 2.3 and C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeatureH</span> <span class="n">hFeature</span><span class="p">;</span>

<span class="n">OGR_L_ResetReading</span><span class="p">(</span><span class="n">hLayer</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">hFeature</span> <span class="o">=</span> <span class="n">OGR_L_GetNextFeature</span><span class="p">(</span><span class="n">hLayer</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
</pre></div>
</div>
<p>In order to dump all the attribute fields of the feature, it is helpful
to get the <a class="reference internal" href="../api/ogrfeature_cpp.html#_CPPv414OGRFeatureDefn" title="OGRFeatureDefn"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">OGRFeatureDefn</span></code></a>.  This is an object, associated with the layer,
containing the definitions of all the fields.  We loop over all the fields,
and fetch and report the attributes based on their type.</p>
<p>With GDAL 2.3 and C++11:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="p">(</span> <span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="nl">oField</span><span class="p">:</span> <span class="o">*</span><span class="n">poFeature</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="nl">OFTInteger</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%d,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetInteger</span><span class="p">()</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTInteger64</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="n">CPL_FRMT_GIB</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetInteger64</span><span class="p">()</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTReal</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetDouble</span><span class="p">()</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTString</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetString</span><span class="p">()</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetAsString</span><span class="p">()</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With GDAL &gt; 2.3 and C++ :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeatureDefn</span> <span class="o">*</span><span class="n">poFDefn</span> <span class="o">=</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetLayerDefn</span><span class="p">();</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">iField</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iField</span> <span class="o">&lt;</span> <span class="n">poFDefn</span><span class="o">-&gt;</span><span class="n">GetFieldCount</span><span class="p">();</span> <span class="n">iField</span><span class="o">++</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">OGRFieldDefn</span> <span class="o">*</span><span class="n">poFieldDefn</span> <span class="o">=</span> <span class="n">poFDefn</span><span class="o">-&gt;</span><span class="n">GetFieldDefn</span><span class="p">(</span> <span class="n">iField</span> <span class="p">);</span>

    <span class="k">switch</span><span class="p">(</span> <span class="n">poFieldDefn</span><span class="o">-&gt;</span><span class="n">GetType</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="nl">OFTInteger</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%d,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsInteger</span><span class="p">(</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTInteger64</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="n">CPL_FRMT_GIB</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsInteger64</span><span class="p">(</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTReal</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsDouble</span><span class="p">(</span><span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTString</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsString</span><span class="p">(</span><span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsString</span><span class="p">(</span><span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeatureDefnH</span> <span class="n">hFDefn</span> <span class="o">=</span> <span class="n">OGR_L_GetLayerDefn</span><span class="p">(</span><span class="n">hLayer</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">iField</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span> <span class="n">iField</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iField</span> <span class="o">&lt;</span> <span class="n">OGR_FD_GetFieldCount</span><span class="p">(</span><span class="n">hFDefn</span><span class="p">);</span> <span class="n">iField</span><span class="o">++</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">OGRFieldDefnH</span> <span class="n">hFieldDefn</span> <span class="o">=</span> <span class="n">OGR_FD_GetFieldDefn</span><span class="p">(</span> <span class="n">hFDefn</span><span class="p">,</span> <span class="n">iField</span> <span class="p">);</span>

    <span class="k">switch</span><span class="p">(</span> <span class="n">OGR_Fld_GetType</span><span class="p">(</span><span class="n">hFieldDefn</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="nl">OFTInteger</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%d,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsInteger</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTInteger64</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="n">CPL_FRMT_GIB</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsInteger64</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTReal</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsDouble</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nl">OFTString</span><span class="p">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsString</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsString</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are a few more field types than those explicitly handled above, but
a reasonable representation of them can be fetched with the
<a class="reference internal" href="../api/ogrfeature_cpp.html#_CPPv4NK10OGRFeature16GetFieldAsStringEi" title="OGRFeature::GetFieldAsString"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRFeature::GetFieldAsString()</span></code></a> method.  In fact we could shorten the above
by using GetFieldAsString() for all the types.</p>
<p>Next we want to extract the geometry from the feature, and write out the point
geometry x and y.   Geometries are returned as a generic <a class="reference internal" href="../api/ogrgeometry_cpp.html#_CPPv411OGRGeometry" title="OGRGeometry"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">OGRGeometry</span></code></a> pointer.
We then determine the specific geometry type, and if it is a point, we
cast it to point and operate on it.  If it is something else we write
placeholders.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeometry</span> <span class="o">*</span><span class="n">poGeometry</span><span class="p">;</span>

<span class="n">poGeometry</span> <span class="o">=</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetGeometryRef</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span> <span class="n">poGeometry</span> <span class="o">!=</span> <span class="nb">NULL</span>
        <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">getGeometryType</span><span class="p">())</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
<span class="p">{</span>
<span class="cp">#if GDAL_VERSION_NUM &gt;= GDAL_COMPUTE_VERSION(2,3,0)</span>
    <span class="n">OGRPoint</span> <span class="o">*</span><span class="n">poPoint</span> <span class="o">=</span> <span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">toPoint</span><span class="p">();</span>
<span class="cp">#else</span>
    <span class="n">OGRPoint</span> <span class="o">*</span><span class="n">poPoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">OGRPoint</span> <span class="o">*</span><span class="p">)</span> <span class="n">poGeometry</span><span class="p">;</span>
<span class="cp">#endif</span>

    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getX</span><span class="p">(),</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getY</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeometryH</span> <span class="n">hGeometry</span><span class="p">;</span>

<span class="n">hGeometry</span> <span class="o">=</span> <span class="n">OGR_F_GetGeometryRef</span><span class="p">(</span><span class="n">hFeature</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">hGeometry</span> <span class="o">!=</span> <span class="nb">NULL</span>
        <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">OGR_G_GetGeometryType</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">))</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">OGR_G_GetX</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">OGR_G_GetY</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">wkbFlatten()</span></code> macro is used above to convert the type for a wkbPoint25D
(a point with a z coordinate) into the base 2D geometry type code (wkbPoint).
For each 2D geometry type there is a corresponding 2.5D type code.  The 2D
and 2.5D geometry cases are handled by the same C++ class, so our code will
handle 2D or 3D cases properly.</p>
<p>Starting with OGR 1.11, several geometry fields can be associated to a feature.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeometry</span> <span class="o">*</span><span class="n">poGeometry</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">iGeomField</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nGeomFieldCount</span><span class="p">;</span>

<span class="n">nGeomFieldCount</span> <span class="o">=</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetGeomFieldCount</span><span class="p">();</span>
<span class="k">for</span><span class="p">(</span><span class="n">iGeomField</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iGeomField</span> <span class="o">&lt;</span> <span class="n">nGeomFieldCount</span><span class="p">;</span> <span class="n">iGeomField</span> <span class="o">++</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">poGeometry</span> <span class="o">=</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetGeomFieldRef</span><span class="p">(</span><span class="n">iGeomField</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poGeometry</span> <span class="o">!=</span> <span class="nb">NULL</span>
            <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">getGeometryType</span><span class="p">())</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
    <span class="p">{</span>
<span class="cp">#if GDAL_VERSION_NUM &gt;= GDAL_COMPUTE_VERSION(2,3,0)</span>
        <span class="n">OGRPoint</span> <span class="o">*</span><span class="n">poPoint</span> <span class="o">=</span> <span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">toPoint</span><span class="p">();</span>
<span class="cp">#else</span>
        <span class="n">OGRPoint</span> <span class="o">*</span><span class="n">poPoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">OGRPoint</span> <span class="o">*</span><span class="p">)</span> <span class="n">poGeometry</span><span class="p">;</span>
<span class="cp">#endif</span>

        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getX</span><span class="p">(),</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getY</span><span class="p">()</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeometryH</span> <span class="n">hGeometry</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">iGeomField</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nGeomFieldCount</span><span class="p">;</span>

<span class="n">nGeomFieldCount</span> <span class="o">=</span> <span class="n">OGR_F_GetGeomFieldCount</span><span class="p">(</span><span class="n">hFeature</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="n">iGeomField</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iGeomField</span> <span class="o">&lt;</span> <span class="n">nGeomFieldCount</span><span class="p">;</span> <span class="n">iGeomField</span> <span class="o">++</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">hGeometry</span> <span class="o">=</span> <span class="n">OGR_F_GetGeomFieldRef</span><span class="p">(</span><span class="n">hFeature</span><span class="p">,</span> <span class="n">iGeomField</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">hGeometry</span> <span class="o">!=</span> <span class="nb">NULL</span>
            <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">OGR_G_GetGeometryType</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">))</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">OGR_G_GetX</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">OGR_G_GetY</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nGeomFieldCount</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetGeomFieldCount</span><span class="p">()</span>
<span class="k">for</span> <span class="n">iGeomField</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nGeomFieldCount</span><span class="p">):</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetGeomFieldRef</span><span class="p">(</span><span class="n">iGeomField</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">geom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetGeometryType</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">wkbPoint</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetX</span><span class="p">(),</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetY</span><span class="p">()</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;no point geometry</span><span class="se">\n</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="../api/ogrfeature_cpp.html#_CPPv4N10OGRFeature14GetGeometryRefEv" title="OGRFeature::GetGeometryRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRFeature::GetGeometryRef()</span></code></a> and <a class="reference internal" href="../api/ogrfeature_cpp.html#_CPPv4N10OGRFeature15GetGeomFieldRefEi" title="OGRFeature::GetGeomFieldRef"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRFeature::GetGeomFieldRef()</span></code></a>
return a pointer to
the internal geometry owned by the OGRFeature.  There we don’t actually
deleted the return geometry.</p>
<p>With GDAL 2.3 and C++11, the looping over features is simply terminated by
a closing curly bracket.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>With GDAL 2.3 and C, the looping over features is simply terminated by
the following.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
<span class="n">OGR_FOR_EACH_FEATURE_END</span><span class="p">(</span><span class="n">hFeature</span><span class="p">)</span>
</pre></div>
</div>
<p>For GDAL &gt; 2.3, as the <a class="reference internal" href="../api/ogrlayer_cpp.html#_CPPv4N8OGRLayer14GetNextFeatureEv" title="OGRLayer::GetNextFeature"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRLayer::GetNextFeature()</span></code></a> method
returns a copy of the feature that is now owned by us.  So at the end of
use we must free the feature.  We could just “delete” it, but this can cause
problems in windows builds where the GDAL DLL has a different “heap” from the
main program.  To be on the safe side we use a GDAL function to delete the
feature.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>    <span class="n">OGRFeature</span><span class="o">::</span><span class="n">DestroyFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>    <span class="n">OGR_F_Destroy</span><span class="p">(</span> <span class="n">hFeature</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The OGRLayer returned by <a class="reference internal" href="../api/gdaldataset_cpp.html#_CPPv4N11GDALDataset14GetLayerByNameEPKc" title="GDALDataset::GetLayerByName"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">GDALDataset::GetLayerByName()</span></code></a> is also a reference
to an internal layer owned by the GDALDataset so we don’t need to delete
it.  But we do need to delete the datasource in order to close the input file.
Once again we do this with a custom delete method to avoid special win32
heap issues.</p>
<p>In C/C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>    <span class="n">GDALClose</span><span class="p">(</span> <span class="n">poDS</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>All together our program looks like this.</p>
<p>With GDAL 2.3 and C++11 :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ogrsf_frmts.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>

<span class="p">{</span>
    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">GDALDatasetUniquePtr</span> <span class="n">poDS</span><span class="p">(</span><span class="n">GDALDataset</span><span class="o">::</span><span class="n">Open</span><span class="p">(</span> <span class="s">&quot;point.shp&quot;</span><span class="p">,</span> <span class="n">GDAL_OF_VECTOR</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poDS</span> <span class="o">==</span> <span class="k">nullptr</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Open failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span> <span class="k">const</span> <span class="n">OGRLayer</span><span class="o">*</span> <span class="nl">poLayer</span><span class="p">:</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">GetLayers</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">poFeature</span><span class="p">:</span> <span class="o">*</span><span class="n">poLayer</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="nl">oField</span><span class="p">:</span> <span class="o">*</span><span class="n">poFeature</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">switch</span><span class="p">(</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">case</span> <span class="nl">OFTInteger</span><span class="p">:</span>
                        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%d,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetInteger</span><span class="p">()</span> <span class="p">);</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="nl">OFTInteger64</span><span class="p">:</span>
                        <span class="n">printf</span><span class="p">(</span> <span class="n">CPL_FRMT_GIB</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetInteger64</span><span class="p">()</span> <span class="p">);</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="nl">OFTReal</span><span class="p">:</span>
                        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetDouble</span><span class="p">()</span> <span class="p">);</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">case</span> <span class="nl">OFTString</span><span class="p">:</span>
                        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetString</span><span class="p">()</span> <span class="p">);</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="k">default</span><span class="o">:</span>
                        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">oField</span><span class="p">.</span><span class="n">GetAsString</span><span class="p">()</span> <span class="p">);</span>
                        <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">const</span> <span class="n">OGRGeometry</span> <span class="o">*</span><span class="n">poGeometry</span> <span class="o">=</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetGeometryRef</span><span class="p">();</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">poGeometry</span> <span class="o">!=</span> <span class="k">nullptr</span>
                    <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">getGeometryType</span><span class="p">())</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">const</span> <span class="n">OGRPoint</span> <span class="o">*</span><span class="n">poPoint</span> <span class="o">=</span> <span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">toPoint</span><span class="p">();</span>

                <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getX</span><span class="p">(),</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getY</span><span class="p">()</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ogrsf_frmts.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>

<span class="p">{</span>
    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">GDALDataset</span> <span class="o">*</span><span class="n">poDS</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">GDALDataset</span><span class="o">*&gt;</span><span class="p">(</span>
        <span class="n">GDALOpenEx</span><span class="p">(</span> <span class="s">&quot;point.shp&quot;</span><span class="p">,</span> <span class="n">GDAL_OF_VECTOR</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">));</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Open failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">OGRLayer</span>  <span class="o">*</span><span class="n">poLayer</span> <span class="o">=</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">GetLayerByName</span><span class="p">(</span> <span class="s">&quot;point&quot;</span> <span class="p">);</span>
    <span class="n">OGRFeatureDefn</span> <span class="o">*</span><span class="n">poFDefn</span> <span class="o">=</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetLayerDefn</span><span class="p">();</span>

    <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">ResetReading</span><span class="p">();</span>
    <span class="n">OGRFeature</span> <span class="o">*</span><span class="n">poFeature</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">poFeature</span> <span class="o">=</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetNextFeature</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">iField</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iField</span> <span class="o">&lt;</span> <span class="n">poFDefn</span><span class="o">-&gt;</span><span class="n">GetFieldCount</span><span class="p">();</span> <span class="n">iField</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OGRFieldDefn</span> <span class="o">*</span><span class="n">poFieldDefn</span> <span class="o">=</span> <span class="n">poFDefn</span><span class="o">-&gt;</span><span class="n">GetFieldDefn</span><span class="p">(</span> <span class="n">iField</span> <span class="p">);</span>

            <span class="k">switch</span><span class="p">(</span> <span class="n">poFieldDefn</span><span class="o">-&gt;</span><span class="n">GetType</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="nl">OFTInteger</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%d,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsInteger</span><span class="p">(</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="nl">OFTInteger64</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="n">CPL_FRMT_GIB</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsInteger64</span><span class="p">(</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="nl">OFTReal</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsDouble</span><span class="p">(</span><span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="nl">OFTString</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsString</span><span class="p">(</span><span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">default</span><span class="o">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetFieldAsString</span><span class="p">(</span><span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">OGRGeometry</span> <span class="o">*</span><span class="n">poGeometry</span> <span class="o">=</span> <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">GetGeometryRef</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">poGeometry</span> <span class="o">!=</span> <span class="nb">NULL</span>
                <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">poGeometry</span><span class="o">-&gt;</span><span class="n">getGeometryType</span><span class="p">())</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OGRPoint</span> <span class="o">*</span><span class="n">poPoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">OGRPoint</span> <span class="o">*</span><span class="p">)</span> <span class="n">poGeometry</span><span class="p">;</span>

            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getX</span><span class="p">(),</span> <span class="n">poPoint</span><span class="o">-&gt;</span><span class="n">getY</span><span class="p">()</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="n">OGRFeature</span><span class="o">::</span><span class="n">DestroyFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">GDALClose</span><span class="p">(</span> <span class="n">poDS</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;gdal.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>

<span class="p">{</span>
    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">GDALDatasetH</span> <span class="n">hDS</span><span class="p">;</span>
    <span class="n">OGRLayerH</span> <span class="n">hLayer</span><span class="p">;</span>
    <span class="n">OGRFeatureH</span> <span class="n">hFeature</span><span class="p">;</span>
    <span class="n">OGRFeatureDefnH</span> <span class="n">hFDefn</span><span class="p">;</span>

    <span class="n">hDS</span> <span class="o">=</span> <span class="n">GDALOpenEx</span><span class="p">(</span> <span class="s">&quot;point.shp&quot;</span><span class="p">,</span> <span class="n">GDAL_OF_VECTOR</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">hDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Open failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">hLayer</span> <span class="o">=</span> <span class="n">GDALDatasetGetLayerByName</span><span class="p">(</span> <span class="n">hDS</span><span class="p">,</span> <span class="s">&quot;point&quot;</span> <span class="p">);</span>
    <span class="n">hFDefn</span> <span class="o">=</span> <span class="n">OGR_L_GetLayerDefn</span><span class="p">(</span><span class="n">hLayer</span><span class="p">);</span>

    <span class="n">OGR_L_ResetReading</span><span class="p">(</span><span class="n">hLayer</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">hFeature</span> <span class="o">=</span> <span class="n">OGR_L_GetNextFeature</span><span class="p">(</span><span class="n">hLayer</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">iField</span><span class="p">;</span>
        <span class="n">OGRGeometryH</span> <span class="n">hGeometry</span><span class="p">;</span>

        <span class="k">for</span><span class="p">(</span> <span class="n">iField</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iField</span> <span class="o">&lt;</span> <span class="n">OGR_FD_GetFieldCount</span><span class="p">(</span><span class="n">hFDefn</span><span class="p">);</span> <span class="n">iField</span><span class="o">++</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OGRFieldDefnH</span> <span class="n">hFieldDefn</span> <span class="o">=</span> <span class="n">OGR_FD_GetFieldDefn</span><span class="p">(</span> <span class="n">hFDefn</span><span class="p">,</span> <span class="n">iField</span> <span class="p">);</span>

            <span class="k">switch</span><span class="p">(</span> <span class="n">OGR_Fld_GetType</span><span class="p">(</span><span class="n">hFieldDefn</span><span class="p">)</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="nl">OFTInteger</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%d,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsInteger</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="nl">OFTInteger64</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="n">CPL_FRMT_GIB</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsInteger64</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="nl">OFTReal</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsDouble</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="nl">OFTString</span><span class="p">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsString</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">default</span><span class="o">:</span>
                    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s,&quot;</span><span class="p">,</span> <span class="n">OGR_F_GetFieldAsString</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">iField</span><span class="p">)</span> <span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">hGeometry</span> <span class="o">=</span> <span class="n">OGR_F_GetGeometryRef</span><span class="p">(</span><span class="n">hFeature</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">hGeometry</span> <span class="o">!=</span> <span class="nb">NULL</span>
            <span class="o">&amp;&amp;</span> <span class="n">wkbFlatten</span><span class="p">(</span><span class="n">OGR_G_GetGeometryType</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">))</span> <span class="o">==</span> <span class="n">wkbPoint</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%.3f,%3.f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">OGR_G_GetX</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">OGR_G_GetY</span><span class="p">(</span><span class="n">hGeometry</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;no point geometry</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="n">OGR_F_Destroy</span><span class="p">(</span> <span class="n">hFeature</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">GDALClose</span><span class="p">(</span> <span class="n">hDS</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OpenEx</span><span class="p">(</span> <span class="s2">&quot;point.shp&quot;</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">OF_VECTOR</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">ds</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Open failed.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

<span class="n">lyr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetLayerByName</span><span class="p">(</span> <span class="s2">&quot;point&quot;</span> <span class="p">)</span>

<span class="n">lyr</span><span class="o">.</span><span class="n">ResetReading</span><span class="p">()</span>

<span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">lyr</span><span class="p">:</span>

    <span class="n">feat_defn</span> <span class="o">=</span> <span class="n">lyr</span><span class="o">.</span><span class="n">GetLayerDefn</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">feat_defn</span><span class="o">.</span><span class="n">GetFieldCount</span><span class="p">()):</span>
        <span class="n">field_defn</span> <span class="o">=</span> <span class="n">feat_defn</span><span class="o">.</span><span class="n">GetFieldDefn</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># Tests below can be simplified with just :</span>
        <span class="c1"># print feat.GetField(i)</span>
        <span class="k">if</span> <span class="n">field_defn</span><span class="o">.</span><span class="n">GetType</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">OFTInteger</span> <span class="ow">or</span> <span class="n">field_defn</span><span class="o">.</span><span class="n">GetType</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">OFTInteger64</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetFieldAsInteger64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field_defn</span><span class="o">.</span><span class="n">GetType</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">OFTReal</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetFieldAsDouble</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">field_defn</span><span class="o">.</span><span class="n">GetType</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">OFTString</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetFieldAsString</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetFieldAsString</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">geom</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">GetGeometryRef</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">geom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetGeometryType</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">wkbPoint</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetX</span><span class="p">(),</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetY</span><span class="p">()</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;no point geometry</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="n">ds</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-to-ogr">
<h2>Writing To OGR<a class="headerlink" href="#writing-to-ogr" title="Permalink to this headline">¶</a></h2>
<p>As an example of writing through OGR, we will do roughly the opposite of the
above.  A short program that reads comma separated values from input text
will be written to a point shapefile via OGR.</p>
<p>As usual, we start by registering all the drivers, and then fetch the
Shapefile driver as we will need it to create our output file.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ogrsf_frmts.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pszDriverName</span> <span class="o">=</span> <span class="s">&quot;ESRI Shapefile&quot;</span><span class="p">;</span>
    <span class="n">GDALDriver</span> <span class="o">*</span><span class="n">poDriver</span><span class="p">;</span>

    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">poDriver</span> <span class="o">=</span> <span class="n">GetGDALDriverManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="n">pszDriverName</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poDriver</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s driver not available.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pszDriverName</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ogr_api.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pszDriverName</span> <span class="o">=</span> <span class="s">&quot;ESRI Shapefile&quot;</span><span class="p">;</span>
    <span class="n">GDALDriver</span> <span class="o">*</span><span class="n">poDriver</span><span class="p">;</span>

    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">poDriver</span> <span class="o">=</span> <span class="p">(</span><span class="n">GDALDriver</span><span class="o">*</span><span class="p">)</span> <span class="n">GDALGetDriverByName</span><span class="p">(</span><span class="n">pszDriverName</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poDriver</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s driver not available.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pszDriverName</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Next we create the datasource.  The ESRI Shapefile driver allows us to create
a directory full of shapefiles, or a single shapefile as a datasource.  In
this case we will explicitly create a single file by including the extension
in the name.  Other drivers behave differently.
The second, third, fourth and fifth argument are related to raster dimensions
(in case the driver has raster capabilities). The last argument to
the call is a list of option values, but we will just be using defaults in
this case.  Details of the options supported are also format specific.</p>
<p>In C ++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">GDALDataset</span> <span class="o">*</span><span class="n">poDS</span><span class="p">;</span>

<span class="n">poDS</span> <span class="o">=</span> <span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">Create</span><span class="p">(</span> <span class="s">&quot;point_out.shp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">GDT_Unknown</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">poDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creation of output file failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">GDALDatasetH</span> <span class="n">hDS</span><span class="p">;</span>

<span class="n">hDS</span> <span class="o">=</span> <span class="n">GDALCreate</span><span class="p">(</span> <span class="n">hDriver</span><span class="p">,</span> <span class="s">&quot;point_out.shp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">GDT_Unknown</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">hDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creation of output file failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we create the output layer.  In this case since the datasource is a
single file, we can only have one layer.  We pass wkbPoint to specify the
type of geometry supported by this layer.  In this case we aren’t passing
any coordinate system information or other special layer creation options.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRLayer</span> <span class="o">*</span><span class="n">poLayer</span><span class="p">;</span>

<span class="n">poLayer</span> <span class="o">=</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">CreateLayer</span><span class="p">(</span> <span class="s">&quot;point_out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">wkbPoint</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Layer creation failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRLayerH</span> <span class="n">hLayer</span><span class="p">;</span>

<span class="n">hLayer</span> <span class="o">=</span> <span class="n">GDALDatasetCreateLayer</span><span class="p">(</span> <span class="n">hDS</span><span class="p">,</span> <span class="s">&quot;point_out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">wkbPoint</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="k">if</span><span class="p">(</span> <span class="n">hLayer</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Layer creation failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now that the layer exists, we need to create any attribute fields that should
appear on the layer.  Fields must be added to the layer before any features
are written.  To create a field we initialize an <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">OGRField</span></code> object with the
information about the field.  In the case of Shapefiles, the field width and
precision is significant in the creation of the output .dbf file, so we
set it specifically, though generally the defaults are OK.  For this example
we will just have one attribute, a name string associated with the x,y point.</p>
<p>Note that the template OGRField we pass to <a class="reference internal" href="../api/ogrlayer_cpp.html#_CPPv4N8OGRLayer11CreateFieldEP12OGRFieldDefni" title="OGRLayer::CreateField"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRLayer::CreateField()</span></code></a> is copied internally.
We retain ownership of the object.</p>
<p>In C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFieldDefn</span> <span class="nf">oField</span><span class="p">(</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">OFTString</span> <span class="p">);</span>

<span class="n">oField</span><span class="p">.</span><span class="n">SetWidth</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateField</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">oField</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating Name field failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFieldDefnH</span> <span class="n">hFieldDefn</span><span class="p">;</span>

<span class="n">hFieldDefn</span> <span class="o">=</span> <span class="n">OGR_Fld_Create</span><span class="p">(</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">OFTString</span> <span class="p">);</span>

<span class="n">OGR_Fld_SetWidth</span><span class="p">(</span> <span class="n">hFieldDefn</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateField</span><span class="p">(</span> <span class="n">hLayer</span><span class="p">,</span> <span class="n">hFieldDefn</span><span class="p">,</span> <span class="n">TRUE</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating Name field failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">OGR_Fld_Destroy</span><span class="p">(</span><span class="n">hFieldDefn</span><span class="p">);</span>
</pre></div>
</div>
<p>The following snipping loops reading lines of the form “x,y,name” from stdin,
and parsing them.</p>
<p>In C++ and in C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">szName</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

<span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">feof</span><span class="p">(</span><span class="n">stdin</span><span class="p">)</span>
       <span class="o">&amp;&amp;</span> <span class="n">fscanf</span><span class="p">(</span> <span class="n">stdin</span><span class="p">,</span> <span class="s">&quot;%lf,%lf,%32s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="n">szName</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
<span class="p">{</span>
</pre></div>
</div>
<p>To write a feature to disk, we must create a local OGRFeature, set attributes
and attach geometry before trying to write it to the layer.  It is
imperative that this feature be instantiated from the OGRFeatureDefn
associated with the layer it will be written to.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span> <span class="o">*</span><span class="n">poFeature</span><span class="p">;</span>

<span class="n">poFeature</span> <span class="o">=</span> <span class="n">OGRFeature</span><span class="o">::</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetLayerDefn</span><span class="p">()</span> <span class="p">);</span>
<span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">SetField</span><span class="p">(</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">szName</span> <span class="p">);</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeatureH</span> <span class="n">hFeature</span><span class="p">;</span>

<span class="n">hFeature</span> <span class="o">=</span> <span class="n">OGR_F_Create</span><span class="p">(</span> <span class="n">OGR_L_GetLayerDefn</span><span class="p">(</span> <span class="n">hLayer</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">OGR_F_SetFieldString</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">OGR_F_GetFieldIndex</span><span class="p">(</span><span class="n">hFeature</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">),</span> <span class="n">szName</span> <span class="p">);</span>
</pre></div>
</div>
<p>We create a local geometry object, and assign its copy (indirectly) to the feature.
The <a class="reference internal" href="../api/ogrfeature_cpp.html#_CPPv4N10OGRFeature19SetGeometryDirectlyEP11OGRGeometry" title="OGRFeature::SetGeometryDirectly"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRFeature::SetGeometryDirectly()</span></code></a> differs from <a class="reference internal" href="../api/ogrfeature_cpp.html#_CPPv4N10OGRFeature11SetGeometryEPK11OGRGeometry" title="OGRFeature::SetGeometry"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRFeature::SetGeometry()</span></code></a>
in that the direct method gives ownership of the geometry to the feature.
This is generally more efficient as it avoids an extra deep object copy
of the geometry.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRPoint</span> <span class="n">pt</span><span class="p">;</span>
<span class="n">pt</span><span class="p">.</span><span class="n">setX</span><span class="p">(</span> <span class="n">x</span> <span class="p">);</span>
<span class="n">pt</span><span class="p">.</span><span class="n">setY</span><span class="p">(</span> <span class="n">y</span> <span class="p">);</span>

<span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">SetGeometry</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pt</span> <span class="p">);</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeometryH</span> <span class="n">hPt</span><span class="p">;</span>
<span class="n">hPt</span> <span class="o">=</span> <span class="n">OGR_G_CreateGeometry</span><span class="p">(</span><span class="n">wkbPoint</span><span class="p">);</span>
<span class="n">OGR_G_SetPoint_2D</span><span class="p">(</span><span class="n">hPt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

<span class="n">OGR_F_SetGeometry</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">hPt</span> <span class="p">);</span>
<span class="n">OGR_G_DestroyGeometry</span><span class="p">(</span><span class="n">hPt</span><span class="p">);</span>
</pre></div>
</div>
<p>Now we create a feature in the file.  The <a class="reference internal" href="../api/ogrlayer_cpp.html#_CPPv4N8OGRLayer13CreateFeatureEP10OGRFeature" title="OGRLayer::CreateFeature"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">OGRLayer::CreateFeature()</span></code></a> does not
take ownership of our feature so we clean it up when done with it.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>     <span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
     <span class="p">{</span>
         <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Failed to create feature in shapefile.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
     <span class="p">}</span>

     <span class="n">OGRFeature</span><span class="o">::</span><span class="n">DestroyFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>     <span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateFeature</span><span class="p">(</span> <span class="n">hLayer</span><span class="p">,</span> <span class="n">hFeature</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
     <span class="p">{</span>
         <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Failed to create feature in shapefile.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
     <span class="p">}</span>

     <span class="n">OGR_F_Destroy</span><span class="p">(</span> <span class="n">hFeature</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally we need to close down the datasource in order to ensure headers
are written out in an orderly way and all resources are recovered.</p>
<p>In C/C++ :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>    <span class="n">GDALClose</span><span class="p">(</span> <span class="n">poDS</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The same program all in one block looks like this:</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;ogrsf_frmts.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pszDriverName</span> <span class="o">=</span> <span class="s">&quot;ESRI Shapefile&quot;</span><span class="p">;</span>
    <span class="n">GDALDriver</span> <span class="o">*</span><span class="n">poDriver</span><span class="p">;</span>

    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">poDriver</span> <span class="o">=</span> <span class="n">GetGDALDriverManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">GetDriverByName</span><span class="p">(</span><span class="n">pszDriverName</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poDriver</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s driver not available.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pszDriverName</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">GDALDataset</span> <span class="o">*</span><span class="n">poDS</span><span class="p">;</span>

    <span class="n">poDS</span> <span class="o">=</span> <span class="n">poDriver</span><span class="o">-&gt;</span><span class="n">Create</span><span class="p">(</span> <span class="s">&quot;point_out.shp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">GDT_Unknown</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creation of output file failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">OGRLayer</span> <span class="o">*</span><span class="n">poLayer</span><span class="p">;</span>

    <span class="n">poLayer</span> <span class="o">=</span> <span class="n">poDS</span><span class="o">-&gt;</span><span class="n">CreateLayer</span><span class="p">(</span> <span class="s">&quot;point_out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">wkbPoint</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Layer creation failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">OGRFieldDefn</span> <span class="n">oField</span><span class="p">(</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">OFTString</span> <span class="p">);</span>

    <span class="n">oField</span><span class="p">.</span><span class="n">SetWidth</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateField</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">oField</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating Name field failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">szName</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

    <span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">feof</span><span class="p">(</span><span class="n">stdin</span><span class="p">)</span>
        <span class="o">&amp;&amp;</span> <span class="n">fscanf</span><span class="p">(</span> <span class="n">stdin</span><span class="p">,</span> <span class="s">&quot;%lf,%lf,%32s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="n">szName</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">OGRFeature</span> <span class="o">*</span><span class="n">poFeature</span><span class="p">;</span>

        <span class="n">poFeature</span> <span class="o">=</span> <span class="n">OGRFeature</span><span class="o">::</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetLayerDefn</span><span class="p">()</span> <span class="p">);</span>
        <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">SetField</span><span class="p">(</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">szName</span> <span class="p">);</span>

        <span class="n">OGRPoint</span> <span class="n">pt</span><span class="p">;</span>

        <span class="n">pt</span><span class="p">.</span><span class="n">setX</span><span class="p">(</span> <span class="n">x</span> <span class="p">);</span>
        <span class="n">pt</span><span class="p">.</span><span class="n">setY</span><span class="p">(</span> <span class="n">y</span> <span class="p">);</span>

        <span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">SetGeometry</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pt</span> <span class="p">);</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Failed to create feature in shapefile.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="n">OGRFeature</span><span class="o">::</span><span class="n">DestroyFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">GDALClose</span><span class="p">(</span> <span class="n">poDS</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;gdal.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pszDriverName</span> <span class="o">=</span> <span class="s">&quot;ESRI Shapefile&quot;</span><span class="p">;</span>
    <span class="n">GDALDriverH</span> <span class="n">hDriver</span><span class="p">;</span>
    <span class="n">GDALDatasetH</span> <span class="n">hDS</span><span class="p">;</span>
    <span class="n">OGRLayerH</span> <span class="n">hLayer</span><span class="p">;</span>
    <span class="n">OGRFieldDefnH</span> <span class="n">hFieldDefn</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">szName</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

    <span class="n">GDALAllRegister</span><span class="p">();</span>

    <span class="n">hDriver</span> <span class="o">=</span> <span class="n">GDALGetDriverByName</span><span class="p">(</span> <span class="n">pszDriverName</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">hDriver</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;%s driver not available.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pszDriverName</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">hDS</span> <span class="o">=</span> <span class="n">GDALCreate</span><span class="p">(</span> <span class="n">hDriver</span><span class="p">,</span> <span class="s">&quot;point_out.shp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">GDT_Unknown</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">hDS</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creation of output file failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">hLayer</span> <span class="o">=</span> <span class="n">GDALDatasetCreateLayer</span><span class="p">(</span> <span class="n">hDS</span><span class="p">,</span> <span class="s">&quot;point_out&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">wkbPoint</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">);</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">hLayer</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Layer creation failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">hFieldDefn</span> <span class="o">=</span> <span class="n">OGR_Fld_Create</span><span class="p">(</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">OFTString</span> <span class="p">);</span>

    <span class="n">OGR_Fld_SetWidth</span><span class="p">(</span> <span class="n">hFieldDefn</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateField</span><span class="p">(</span> <span class="n">hLayer</span><span class="p">,</span> <span class="n">hFieldDefn</span><span class="p">,</span> <span class="n">TRUE</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating Name field failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">OGR_Fld_Destroy</span><span class="p">(</span><span class="n">hFieldDefn</span><span class="p">);</span>

    <span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="n">feof</span><span class="p">(</span><span class="n">stdin</span><span class="p">)</span>
        <span class="o">&amp;&amp;</span> <span class="n">fscanf</span><span class="p">(</span> <span class="n">stdin</span><span class="p">,</span> <span class="s">&quot;%lf,%lf,%32s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="n">szName</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">OGRFeatureH</span> <span class="n">hFeature</span><span class="p">;</span>
        <span class="n">OGRGeometryH</span> <span class="n">hPt</span><span class="p">;</span>

        <span class="n">hFeature</span> <span class="o">=</span> <span class="n">OGR_F_Create</span><span class="p">(</span> <span class="n">OGR_L_GetLayerDefn</span><span class="p">(</span> <span class="n">hLayer</span> <span class="p">)</span> <span class="p">);</span>
        <span class="n">OGR_F_SetFieldString</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">OGR_F_GetFieldIndex</span><span class="p">(</span><span class="n">hFeature</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">),</span> <span class="n">szName</span> <span class="p">);</span>

        <span class="n">hPt</span> <span class="o">=</span> <span class="n">OGR_G_CreateGeometry</span><span class="p">(</span><span class="n">wkbPoint</span><span class="p">);</span>
        <span class="n">OGR_G_SetPoint_2D</span><span class="p">(</span><span class="n">hPt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>

        <span class="n">OGR_F_SetGeometry</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span> <span class="n">hPt</span> <span class="p">);</span>
        <span class="n">OGR_G_DestroyGeometry</span><span class="p">(</span><span class="n">hPt</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateFeature</span><span class="p">(</span> <span class="n">hLayer</span><span class="p">,</span> <span class="n">hFeature</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
        <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Failed to create feature in shapefile.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="n">OGR_F_Destroy</span><span class="p">(</span> <span class="n">hFeature</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">GDALClose</span><span class="p">(</span> <span class="n">hDS</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In Python :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">ogr</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="n">driverName</span> <span class="o">=</span> <span class="s2">&quot;ESRI Shapefile&quot;</span>
<span class="n">drv</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GetDriverByName</span><span class="p">(</span> <span class="n">driverName</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">drv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> driver not available.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">driverName</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">drv</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span> <span class="s2">&quot;point_out.shp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Unknown</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">ds</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Creation of output file failed.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

<span class="n">lyr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">CreateLayer</span><span class="p">(</span> <span class="s2">&quot;point_out&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">ogr</span><span class="o">.</span><span class="n">wkbPoint</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">lyr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Layer creation failed.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

<span class="n">field_defn</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">FieldDefn</span><span class="p">(</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">ogr</span><span class="o">.</span><span class="n">OFTString</span> <span class="p">)</span>
<span class="n">field_defn</span><span class="o">.</span><span class="n">SetWidth</span><span class="p">(</span> <span class="mi">32</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">lyr</span><span class="o">.</span><span class="n">CreateField</span> <span class="p">(</span> <span class="n">field_defn</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Creating Name field failed.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

<span class="c1"># Expected format of user input: x y name</span>
<span class="n">linestring</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span>
<span class="n">linelist</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">linestring</span><span class="p">)</span>

<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">linelist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">linelist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">linelist</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">linelist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">feat</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span> <span class="n">lyr</span><span class="o">.</span><span class="n">GetLayerDefn</span><span class="p">())</span>
    <span class="n">feat</span><span class="o">.</span><span class="n">SetField</span><span class="p">(</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="p">)</span>

    <span class="n">pt</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">Geometry</span><span class="p">(</span><span class="n">ogr</span><span class="o">.</span><span class="n">wkbPoint</span><span class="p">)</span>
    <span class="n">pt</span><span class="o">.</span><span class="n">SetPoint_2D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">feat</span><span class="o">.</span><span class="n">SetGeometry</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lyr</span><span class="o">.</span><span class="n">CreateFeature</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;Failed to create feature in shapefile.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>

    <span class="n">feat</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>

    <span class="n">linestring</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span>
    <span class="n">linelist</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">linestring</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
<p>Starting with OGR 1.11, everal geometry fields&lt; can be associated to a feature. This capability
is just available for a few file formats, such as PostGIS.</p>
<p>To create such datasources, geometry fields must be first created.
Spatial reference system objects can be associated to each geometry field.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeomFieldDefn</span> <span class="nf">oPointField</span><span class="p">(</span> <span class="s">&quot;PointField&quot;</span><span class="p">,</span> <span class="n">wkbPoint</span> <span class="p">);</span>
<span class="n">OGRSpatialReference</span><span class="o">*</span> <span class="n">poSRS</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OGRSpatialReference</span><span class="p">();</span>
<span class="n">poSRS</span><span class="o">-&gt;</span><span class="n">importFromEPSG</span><span class="p">(</span><span class="mi">4326</span><span class="p">);</span>
<span class="n">oPointField</span><span class="p">.</span><span class="n">SetSpatialRef</span><span class="p">(</span><span class="n">poSRS</span><span class="p">);</span>
<span class="n">poSRS</span><span class="o">-&gt;</span><span class="n">Release</span><span class="p">();</span>

<span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateGeomField</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">oPointField</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating field PointField failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">OGRGeomFieldDefn</span> <span class="n">oFieldPoint2</span><span class="p">(</span> <span class="s">&quot;PointField2&quot;</span><span class="p">,</span> <span class="n">wkbPoint</span> <span class="p">);</span>
<span class="n">poSRS</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OGRSpatialReference</span><span class="p">();</span>
<span class="n">poSRS</span><span class="o">-&gt;</span><span class="n">importFromEPSG</span><span class="p">(</span><span class="mi">32631</span><span class="p">);</span>
<span class="n">oPointField2</span><span class="p">.</span><span class="n">SetSpatialRef</span><span class="p">(</span><span class="n">poSRS</span><span class="p">);</span>
<span class="n">poSRS</span><span class="o">-&gt;</span><span class="n">Release</span><span class="p">();</span>

<span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateGeomField</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">oPointField2</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating field PointField2 failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRGeomFieldDefnH</span> <span class="n">hPointField</span><span class="p">;</span>
<span class="n">OGRGeomFieldDefnH</span> <span class="n">hPointField2</span><span class="p">;</span>
<span class="n">OGRSpatialReferenceH</span> <span class="n">hSRS</span><span class="p">;</span>

<span class="n">hPointField</span> <span class="o">=</span> <span class="n">OGR_GFld_Create</span><span class="p">(</span> <span class="s">&quot;PointField&quot;</span><span class="p">,</span> <span class="n">wkbPoint</span> <span class="p">);</span>
<span class="n">hSRS</span> <span class="o">=</span> <span class="n">OSRNewSpatialReference</span><span class="p">(</span> <span class="nb">NULL</span> <span class="p">);</span>
<span class="n">OSRImportFromEPSG</span><span class="p">(</span><span class="n">hSRS</span><span class="p">,</span> <span class="mi">4326</span><span class="p">);</span>
<span class="n">OGR_GFld_SetSpatialRef</span><span class="p">(</span><span class="n">hPointField</span><span class="p">,</span> <span class="n">hSRS</span><span class="p">);</span>
<span class="n">OSRRelease</span><span class="p">(</span><span class="n">hSRS</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateGeomField</span><span class="p">(</span> <span class="n">hLayer</span><span class="p">,</span> <span class="n">hPointField</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating field PointField failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">OGR_GFld_Destroy</span><span class="p">(</span> <span class="n">hPointField</span> <span class="p">);</span>

<span class="n">hPointField2</span> <span class="o">=</span> <span class="n">OGR_GFld_Create</span><span class="p">(</span> <span class="s">&quot;PointField2&quot;</span><span class="p">,</span> <span class="n">wkbPoint</span> <span class="p">);</span>
<span class="n">OSRImportFromEPSG</span><span class="p">(</span><span class="n">hSRS</span><span class="p">,</span> <span class="mi">32631</span><span class="p">);</span>
<span class="n">OGR_GFld_SetSpatialRef</span><span class="p">(</span><span class="n">hPointField2</span><span class="p">,</span> <span class="n">hSRS</span><span class="p">);</span>
<span class="n">OSRRelease</span><span class="p">(</span><span class="n">hSRS</span><span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateGeomField</span><span class="p">(</span> <span class="n">hLayer</span><span class="p">,</span> <span class="n">hPointField2</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Creating field PointField2 failed.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">OGR_GFld_Destroy</span><span class="p">(</span> <span class="n">hPointField2</span> <span class="p">);</span>
</pre></div>
</div>
<p>To write a feature to disk, we must create a local OGRFeature, set attributes
and attach geometries before trying to write it to the layer.  It is
imperative that this feature be instantiated from the OGRFeatureDefn
associated with the layer it will be written to.</p>
<p>In C++ :</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeature</span> <span class="o">*</span><span class="n">poFeature</span><span class="p">;</span>
<span class="n">OGRGeometry</span> <span class="o">*</span><span class="n">poGeometry</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">pszWKT</span><span class="p">;</span>

<span class="n">poFeature</span> <span class="o">=</span> <span class="n">OGRFeature</span><span class="o">::</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">GetLayerDefn</span><span class="p">()</span> <span class="p">);</span>

<span class="n">pszWKT</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="s">&quot;POINT (2 49)&quot;</span><span class="p">;</span>
<span class="n">OGRGeometryFactory</span><span class="o">::</span><span class="n">createFromWkt</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pszWKT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">poGeometry</span> <span class="p">);</span>
<span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">SetGeomFieldDirectly</span><span class="p">(</span> <span class="s">&quot;PointField&quot;</span><span class="p">,</span> <span class="n">poGeometry</span> <span class="p">);</span>

<span class="n">pszWKT</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="s">&quot;POINT (500000 4500000)&quot;</span><span class="p">;</span>
<span class="n">OGRGeometryFactory</span><span class="o">::</span><span class="n">createFromWkt</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pszWKT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">poGeometry</span> <span class="p">);</span>
<span class="n">poFeature</span><span class="o">-&gt;</span><span class="n">SetGeomFieldDirectly</span><span class="p">(</span> <span class="s">&quot;PointField2&quot;</span><span class="p">,</span> <span class="n">poGeometry</span> <span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">poLayer</span><span class="o">-&gt;</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Failed to create feature.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">OGRFeature</span><span class="o">::</span><span class="n">DestroyFeature</span><span class="p">(</span> <span class="n">poFeature</span> <span class="p">);</span>
</pre></div>
</div>
<p>In C :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">OGRFeatureH</span> <span class="n">hFeature</span><span class="p">;</span>
<span class="n">OGRGeometryH</span> <span class="n">hGeometry</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">pszWKT</span><span class="p">;</span>

<span class="n">poFeature</span> <span class="o">=</span> <span class="n">OGR_F_Create</span><span class="p">(</span> <span class="n">OGR_L_GetLayerDefn</span><span class="p">(</span><span class="n">hLayer</span><span class="p">)</span> <span class="p">);</span>

<span class="n">pszWKT</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="s">&quot;POINT (2 49)&quot;</span><span class="p">;</span>
<span class="n">OGR_G_CreateFromWkt</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pszWKT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hGeometry</span> <span class="p">);</span>
<span class="n">OGR_F_SetGeomFieldDirectly</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span>
    <span class="n">OGR_F_GetGeomFieldIndex</span><span class="p">(</span><span class="n">hFeature</span><span class="p">,</span> <span class="s">&quot;PointField&quot;</span><span class="p">),</span> <span class="n">hGeometry</span> <span class="p">);</span>

<span class="n">pszWKT</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="s">&quot;POINT (500000 4500000)&quot;</span><span class="p">;</span>
<span class="n">OGR_G_CreateFromWkt</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">pszWKT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hGeometry</span> <span class="p">);</span>
<span class="n">OGR_F_SetGeomFieldDirectly</span><span class="p">(</span> <span class="n">hFeature</span><span class="p">,</span>
    <span class="n">OGR_F_GetGeomFieldIndex</span><span class="p">(</span><span class="n">hFeature</span><span class="p">,</span> <span class="s">&quot;PointField2&quot;</span><span class="p">),</span> <span class="n">hGeometry</span> <span class="p">);</span>

<span class="k">if</span><span class="p">(</span> <span class="n">OGR_L_CreateFeature</span><span class="p">(</span> <span class="n">hFeature</span> <span class="p">)</span> <span class="o">!=</span> <span class="n">OGRERR_NONE</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Failed to create feature.</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">OGR_F_Destroy</span><span class="p">(</span> <span class="n">hFeature</span> <span class="p">);</span>
</pre></div>
</div>
<p>In Python :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">feat</span> <span class="o">=</span> <span class="n">ogr</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span> <span class="n">lyr</span><span class="o">.</span><span class="n">GetLayerDefn</span><span class="p">()</span> <span class="p">)</span>

<span class="n">feat</span><span class="o">.</span><span class="n">SetGeomFieldDirectly</span><span class="p">(</span> <span class="s2">&quot;PointField&quot;</span><span class="p">,</span>
    <span class="n">ogr</span><span class="o">.</span><span class="n">CreateGeometryFromWkt</span><span class="p">(</span> <span class="s2">&quot;POINT (2 49)&quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">feat</span><span class="o">.</span><span class="n">SetGeomFieldDirectly</span><span class="p">(</span> <span class="s2">&quot;PointField2&quot;</span><span class="p">,</span>
    <span class="n">ogr</span><span class="o">.</span><span class="n">CreateGeometryFromWkt</span><span class="p">(</span> <span class="s2">&quot;POINT (500000 4500000)&quot;</span> <span class="p">)</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">lyr</span><span class="o">.</span><span class="n">CreateFeature</span><span class="p">(</span> <span class="n">feat</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">print</span><span class="p">(</span> <span class="s2">&quot;Failed to create feature.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">);</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span> <span class="mi">1</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vector_driver_tut.html" class="btn btn-neutral float-right" title="Vector driver implementation tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="multidimensional_api_tut.html" class="btn btn-neutral float-left" title="Multidimensional raster API tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://osgeo.org">
        <div class="osgeo-logo"></div>
      </a>
      <div class="copyright">
      

      &copy; 1998-2019 <a href="https://github.com/warmerdam">Frank Warmerdam</a>,
      <a href="https://github.com/rouault">Even Rouault</a>, and
      <a href="https://github.com/OSGeo/gdal/graphs/contributors">others</a>


      
      </div>
    </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>